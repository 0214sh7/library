<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>すくライブラリ</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="すくライブラリ" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/library/posts/wild" />
<meta property="og:url" content="http://localhost:4000/library/posts/wild" />
<meta property="og:site_name" content="すくライブラリ" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0000-01-01T00:01:58+09:18" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="すくライブラリ" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"0000-01-01T00:01:58+09:18","datePublished":"0000-01-01T00:01:58+09:18","headline":"すくライブラリ","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/library/posts/wild"},"url":"http://localhost:4000/library/posts/wild"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/library/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/library/feed.xml" title="すくライブラリ" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/library/">すくライブラリ</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/library/about/">ABOUT</a><a class="page-link" href="/library/license/">LICENSE</a><a class="page-link" href="/library/whatwecan/">できること一覧</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">すくライブラリ</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="0000-01-01T00:01:58+09:18" itemprop="datePublished">Jan 1, 0000
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!DOCTYPE html>
<html lang='ja'>
  <head>
    <meta charset="utf-8">
    <title>すくライブラリ</title>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  
  <body>
    <style>
    pre, code {
        white-space: pre-wrap;
    }
</style>

<h2>数学</h2>
<ul>
  <li><a href="./posts/basic-math">数学詰め合わせパック</a></li>
  <li><a href="./posts/binomial-coefficient">素数mod二項係数</a></li>
  <li><a href="./posts/sieve">素因数分解(線形篩)</a></li>
  <li><a href="./posts/bezout-coef">拡張ユークリッドの互除法</a></li>
  <li><a href="./posts/convexhull">凸包</a></li>
  <li><a href="./posts/totient">オイラーのφ関数</a></li>
  <li><a href="./posts/fft">高速フーリエ変換(FFT)</a></li>
  <li><a href="./posts/ntt">数論変換(NTT)</a></li>
  <li><a href="./posts/composite-binomial-coefficient">任意mod二項係数</a></li>
</ul>

<h2>アルゴリズム</h2>
<ul>
  <li><a href="./posts/vector2d-rotate">二次元配列の回転</a></li>
  <li><a href="./posts/run-length-encode">ランレングス圧縮</a></li>
  <li><a href="./posts/arg-sort">偏角ソート</a></li>
  <li><a href="./posts/iterated-function">反復写像</a></li>
  <li><a href="./posts/slideminimum">スライド最小値</a></li>
  <li><a href="./posts/compress">座標圧縮</a></li>
  <li><a href="./posts/lis">最長増加部分列</a></li>
  <li><a href="./posts/mos-algorithm">Moのアルゴリズム</a></li>
  <li><a href="./posts/rollinghash">ローリングハッシュ</a></li>
</ul>

<h2>グラフ</h2>
<ul>
  <li><a href="./posts/dijkstra">ダイクストラ法</a></li>
  <li><a href="./posts/bellmanford">ベルマンフォード法</a></li>
  <li><a href="./posts/kruskal">クラスカル法</a></li>
  <li><a href="./posts/bipartite">二部グラフ判定</a></li>
  <li><a href="./posts/double-sweep">木の直径</a></li>
  <li><a href="./posts/lowest-common-ancestor">最小共通祖先</a></li>
  <li><a href="./posts/dinic">ディニッツ法</a></li>
</ul>

<h2>データ構造</h2>
<ul>
  <li><a href="./posts/segmenttree">セグメント木</a></li>
  <li><a href="./posts/fenwicktree">フェニック木</a></li>
  <li><a href="./posts/unionfind">UnionFind</a></li>
  <li><a href="./posts/pot-unionfind">ポテンシャル付きUnionFind</a></li>
</ul>

<hr />
<div style="page-break-after: always;"></div>

<h1 id="-数学詰め合わせパック-">🔴 数学詰め合わせパック 🔴</h1>

<p>優柔不断なあなたに</p>

<p>というのは建前で、それぞれ独立して扱うほどではないが重要なものを一箇所に集めた</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/basic%20math%20assortment.cpp">github</a></p>

<h1 id="もくじ">もくじ</h1>
<ul>
  <li><a href="#小数点以下切り上げ天井関数">小数点以下切り上げ(天井関数)</a></li>
  <li><a href="#階乗">階乗</a></li>
  <li><a href="#最大公約数">最大公約数</a></li>
  <li><a href="#最小公倍数">最小公倍数</a></li>
  <li><a href="#約数列挙">約数列挙</a></li>
  <li><a href="#素数判定">素数判定</a></li>
  <li><a href="#素数列挙">素数列挙</a></li>
  <li><a href="#素因数分解">素因数分解</a></li>
  <li><a href="#累乗繰り返し二乗法">累乗(繰り返し二乗法)</a></li>
  <li><a href="#逆元素数mod">逆元(素数MOD)</a></li>
</ul>

<hr />

<h2 id="小数点以下切り上げ天井関数">小数点以下切り上げ(天井関数)</h2>

<ul>
  <li>よくある天井関数</li>
  <li>計算量は\(Ο(1)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">roundup</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例">使用例</h3>

<h4 id="実行コード">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">roundup</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">roundup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 2 3 4 5 6 7 8 9 10 
0 1 1 1 1 2 2 2 2 3 3 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="階乗">階乗</h2>

<ul>
  <li>与えられた\(x\)に対し\(x!\)を計算する</li>
  <li>\(MOD\)も与えるとそれで割った余りをとる</li>
  <li>計算量は\(Ο(x)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">fact</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-1">使用例</h3>

<h4 id="実行コード-1">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">fact</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">fact</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-1">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 1 2 6 24 120 720 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="最大公約数">最大公約数</h2>

<ul>
  <li>２つの引数のGCDを求める</li>
  <li>計算量は\(O(log(max(a,b)))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">a</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="n">b</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
        <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">b</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-2">使用例</h3>

<h4 id="実行コード-2">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-2">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
1
6
1
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="最小公倍数">最小公倍数</h2>

<ul>
  <li>２つの引数のLCMを求める</li>
  <li>計算量は\(O(log(max(a,b)))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">lcm</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">s</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
    <span class="n">a</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="n">b</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
        <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">b</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-3">使用例</h3>

<h4 id="実行コード-3">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">lcm</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-3">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>12
15
36
104
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="約数列挙">約数列挙</h2>

<ul>
  <li>自然数\(N\)を与えると、\(N\)の正の約数を小さい順に並べたvectorを返す</li>
  <li>正でない数を与えると空のvectorを返す</li>
  <li>計算量は\(O(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">!=</span><span class="n">N</span><span class="p">)</span><span class="n">s</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-4">使用例</h3>

<h4 id="実行コード-4">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">K</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-4">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1  1 
2  1 2 
3  1 3 
4  1 2 4 
5  1 5 
6  1 2 3 6 
7  1 7 
8  1 2 4 8 
9  1 3 9 
10  1 2 5 10 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="素数判定">素数判定</h2>

<ul>
  <li>与えられた\(x\)に対し、\(x\)が素数ならtrueを、そうでないならfalseを返す</li>
  <li>計算量は\(O(\sqrt{x})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="nf">prime</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">X</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-5">使用例</h3>

<h4 id="実行コード-5">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">bool</span> <span class="nf">prime</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">prime</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-5">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 2 3 4 5 6 7 8 9 10 
0 0 1 1 0 1 0 1 0 0 0 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="素数列挙">素数列挙</h2>

<ul>
  <li>与えられた\(N\)に対し、\(N\)以下の素数を列挙し、小さい順にvectorとして返す</li>
  <li>計算量は\(O(NloglogN)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">prime</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">prime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="n">prime</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
            <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-6">使用例</h3>

<h4 id="実行コード-6">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">primearray</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-6">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="素因数分解">素因数分解</h2>

<ul>
  <li>与えられた\(N\)に対し、\(N\)を素因数分解し、小さい順にvectorとして返す</li>
  <li>計算量は\(Ο(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">N</span><span class="o">/=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
          <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-7">使用例</h3>

<h4 id="実行コード-7">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">210</span><span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-7">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4  2 2 
12  2 2 3 
57  3 19 
97  97 
210  2 3 5 7 
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="累乗繰り返し二乗法">累乗(繰り返し二乗法)</h2>

<ul>
  <li>与えられた\(b,e\)に対し、\(b^e\)を返す</li>
  <li>\(MOD\)も与えるとそれで割った余りをとる</li>
  <li>計算量は\(Ο(log(e))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-8">使用例</h3>

<h4 id="実行コード-8">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"2のi乗"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"2のi乗を100で割ったあまり"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-8">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2のi乗
1 2 4 8 16 32 64 128 256 512 1024 
2のi乗を100で割ったあまり
1 2 4 8 16 32 64 28 56 12 24
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="逆元素数mod">逆元(素数MOD)</h2>

<ul>
  <li>与えられた\(b,MOD\)に対し、\(MOD\)を法とした整数環上での逆元(\(bx=1\)を満たす\(x\))を返す</li>
  <li>MODが素数でない場合の動作は未確認</li>
  <li>計算量は\(Ο(log(MOD))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">inverse</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="使用例-9">使用例</h3>

<h4 id="実行コード-9">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">inverse</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"mod 7でのiの逆元"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">7</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">inverse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">%</span><span class="mi">7</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-9">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mod 7でのiの逆元
1 1 1
2 4 1
3 5 1
4 2 1
5 3 1
6 6 1
</code></pre></div></div>

<p><a href="#もくじ">もくじに戻る</a></p>

<hr />

<h2 id="更新履歴">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/05</td>
      <td style="text-align: left">約数列挙を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/27</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">軽微なバグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">アンカーリンクを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/06/01</td>
      <td style="text-align: left">素因数分解のバグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/03</td>
      <td style="text-align: left">数学詰め合わせパックを追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-素数mod二項係数-">🔴 素数mod二項係数 🔴</h1>

<p>init</p>
<ul>
  <li>整数\(N\)を与えると、combを実行するのに必要な数値(階乗とその逆元)を前計算する</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>binomial_coefficient</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>extension</p>
<ul>
  <li>initで用意した範囲で足りない場合、整数\(N\)を与えると不足分を追加で前計算する</li>
  <li>計算量は実行前のサイズを\(s\)として、\(Ο(N-s+log(MOD))\)</li>
</ul>

<p>comb</p>
<ul>
  <li>整数\(n,r\)を与えると、\(\frac{n!}{r!(n-r)!}\)を\(MOD\)で割った余りを返す</li>
  <li>もしこれを計算するための前計算が不足している場合、ちょうど補完するようにextensionが実行される</li>
  <li>このため、計算量を気にしなければinitは呼ばなくても良い</li>
  <li>また最初にinitに十分な値を与えていればextensionは呼ばれない</li>
  <li>計算量はextensionのもの+\(Ο(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/binomial%20coefficient.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">binomial_coefficient</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">998244353</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">sze</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">fact</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factinv</span><span class="p">;</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Gfinv</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="o">=</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        
        <span class="n">fact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">factinv</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gfinv</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">N</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">binomial_coefficient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">extension</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sze</span><span class="o">&gt;</span><span class="n">N</span> <span class="o">&amp;&amp;</span> <span class="n">sze</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">;</span>
        <span class="p">}</span>
        
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        
        <span class="n">fact</span><span class="p">[</span><span class="n">sze</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">sze</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">sze</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sze</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">sze</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">factinv</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gfinv</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">N</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">sze</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;=</span><span class="n">sze</span><span class="p">){</span>
            <span class="n">extension</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">r</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-10">使用例</h2>
<hr />

<h3 id="実行コード-10">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">binomial_coefficient</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">binomial_coefficient</span> <span class="n">BC</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-10">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 0 0 0 0 0 
1 1 0 0 0 0 
1 2 1 0 0 0 
1 3 3 1 0 0 
1 4 6 4 1 0 
1 5 10 10 5 1 
</code></pre></div></div>

<h2 id="更新履歴-1">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">名称を二項係数から素数mod二項係数に変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/02/18</td>
      <td style="text-align: left">nを指定してvectorを返す形式からclass化しn,rからnCrを返す形式に変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">二項係数を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-素因数分解線形篩-">🔴 素因数分解(線形篩) 🔴</h1>

<p>init</p>
<ul>
  <li>整数\(N\)を与えると、前計算として\(N\)以下の合成数\(i\)について\(i\)の自明でない(\(1\)でも\(i\)でもない)約数の1つを求める</li>
  <li>それと同時に、\(N\)以下の素数のリストも求める</li>
  <li>以降の関数に\(N\)より大きい値を与えると補完のためにinitが呼ばれる。これは最初にinitに十分大きい値を与えることで回避できる</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>linear_sieve</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>primearray</p>
<ul>
  <li>整数\(N\)を与えると、\(N\)以下の素数を昇順に並べたvectorを返す</li>
  <li>もし前計算が足りない場合、ちょうど補完するようにinitが実行される</li>
  <li>計算量はinitのもの+\(Ο(N/log(N))\)</li>
</ul>

<p>divisor</p>
<ul>
  <li>整数\(N\)を与えると、前計算した\(N\)の自明でない約数の1つを返す</li>
  <li>もし\(N\)が素数なら\(N\)を、\(1\)なら\(1\)を、正でないなら\(-1\)を返す</li>
  <li>もし前計算が足りない場合、ちょうど補完するようにinitが実行される</li>
  <li>計算量はinitのもの+\(Ο(1)\)</li>
</ul>

<p>factorization</p>
<ul>
  <li>整数\(X\)を与えると、\(X\)を素因数分解し、結果を<strong>大きい順に</strong>並べ、vectorとして返す</li>
  <li>もし前計算が足りない場合、ちょうど補完するようにinitが実行される</li>
  <li>計算量はinitのもの+\(Ο(log(N))\)</li>
</ul>

<p>exp_enum</p>
<ul>
  <li>整数\(N,M,mod\)を与えると、\(0^M,1^M,...,N^M\)をそれぞれ\(mod\)で割ったあまりを計算し、vectorとして返す</li>
  <li>\(N,M\)が負である場合、空のvectorを返す</li>
  <li>もし前計算が足りない場合、ちょうど補完するようにinitが実行される</li>
  <li>計算量はinitのもの+\(Ο(N + N \frac{log(M)}{log(N)})\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/linear%20sieve.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">linear_sieve</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">S</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_</span><span class="p">,</span><span class="n">prime</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">S</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">divisor_</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">divisor_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
                <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">N</span> <span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">divisor_</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">linear_sieve</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">X</span><span class="p">){</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">divisor</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">factorization</span><span class="p">(</span><span class="n">X</span><span class="o">/</span><span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">]);</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">]);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">exp_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">)</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">N</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">e</span><span class="o">=</span><span class="n">M</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">R</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-11">使用例</h2>
<hr />

<h3 id="実行コード-11">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">linear_sieve</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">linear_sieve</span> <span class="n">sieve</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"100以下の素数のリスト"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">primearray</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"1~10の約数の一つ"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">sieve</span><span class="p">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"4,12,57,97,210の素因数分解"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">210</span><span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">factorization</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0~10について、i^3"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">exp_enum</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-11">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100以下の素数のリスト
2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 

1~10の約数の一つ
1 2 3 2 5 2 7 2 3 2 

4,12,57,97,210の素因数分解
2 2 
3 2 2 
19 3 
97 
7 5 3 2 

0~10について、i^3
0 1 8 27 64 125 216 343 512 729 1000 
</code></pre></div></div>

<h2 id="更新履歴-2">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/24</td>
      <td style="text-align: left">素因数分解(線形篩)を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-拡張ユークリッドの互除法-">🔴 拡張ユークリッドの互除法 🔴</h1>

<p>拡張ユークリッドの互除法、extended Euclidean algorithmの対訳感がそんなにないね　どうでもいいね</p>

<p>整数\(a,b\)を与えると、\(g=gcd(a,b)\)とそれを用いて表される等式</p>

\[ax+by=g\]

<p>を満たす\((x,y)\)(ベズー係数)を一つ求め、\(g\)とともに返す</p>

<p>計算量は\(O(log(max(a,b)))\)</p>

<p>ここで返り値はpair&lt;ll,pair&lt;ll,ll»となっているが、それぞれ\(\{g,\{x,y\}\}\)を表している</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/extended%20Euclidean%20algorithm.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">extgcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">b</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
        <span class="n">r</span><span class="o">+=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">r</span><span class="o">%=</span><span class="n">b</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">q_</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q_</span><span class="p">);</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">g</span><span class="o">*=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">x</span><span class="o">*=-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="n">g</span><span class="p">,{</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">}};</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-12">使用例</h2>
<hr />

<h3 id="実行コード-12">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">extgcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">extgcd</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111と30の最大公約数"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111x+30y=3を満たすような(x,y)の一例"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111x+30y"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">111</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">30</span><span class="o">*</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-12">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>111と30の最大公約数
3

111x+30y=3を満たすような(x,y)の一例
(3,-11)

111x+30y
3
</code></pre></div></div>

<h2 id="更新履歴-3">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/08</td>
      <td style="text-align: left">欠落していた計算量を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/08</td>
      <td style="text-align: left">拡張ユークリッドの互除法を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-凸包-">🔴 凸包 🔴</h1>

<p>アルゴリズムはAndrewのmonotone chainという名前らしい</p>

<p>二次元上の点集合をvector&lt;pair&lt;long long,long long»で与える</p>

<p>するとその点集合の凸包を求め、x座標が最も小さい点のうちy座標が最も小さい点から始めて反時計回りに並べてvector&lt;pair&lt;long long,long long»で返す</p>

<p>計算量は\(O(\vert P \vert log \vert P \vert)\)(ソートがネックになっており、ソートがなければ\(O(\vert P \vert)\))</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/convex%20hull.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">H</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">;</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    
    <span class="c1">//下半分</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">L</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)){</span>
            <span class="n">L</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">L</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="c1">//上半分</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)){</span>
            <span class="n">H</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">H</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    
    <span class="n">R</span><span class="o">=</span><span class="n">L</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">H</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-13">使用例</h2>
<hr />

<h3 id="実行コード-13">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">;</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    
    <span class="n">Q</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Q</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-13">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 0
2 0
2 2
0 2
</code></pre></div></div>

<h2 id="更新履歴-4">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/22</td>
      <td style="text-align: left">凸包を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-オイラーのφ関数-">🔴 オイラーのφ関数 🔴</h1>

<p>\(\varphi\)はトーシェントと読むらしい</p>

<p>\(\varphi(n)\)とは、\(1\)から\(n\)までの整数で、\(n\)と互いに素であるものの個数</p>

<p>これは、\(n\)が相違な素因数\(p_1,p_2,...,p_d\)を含むとして</p>

\[\varphi(n) = n\prod_{k=1}^d (1-\frac{1}{p_k})\]

<p>と計算することができる</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/Euler's%20totient%20function.cpp">github</a></p>

<p>単体</p>
<ul>
  <li>整数\(N\)を与えると、\(\varphi(N)\)を計算し整数で返す</li>
  <li>計算量は\(O(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">totient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">R</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span> <span class="o">-=</span> <span class="n">R</span><span class="o">/</span><span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">N</span><span class="o">/=</span><span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">R</span> <span class="o">-=</span> <span class="n">R</span><span class="o">/</span><span class="n">N</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>列挙</p>
<ul>
  <li>整数\(N\)を与えると、\(0\)から\(N\)までの\(\varphi(i)\)を計算し,要素数が\(N+1\)のvectorで返す</li>
  <li>ここで、\(\varphi(0)=0\)としている</li>
  <li>計算量は\(O(NloglogN)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">totient_array</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
            <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-=</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-14">使用例</h2>
<hr />

<h3 id="実行コード-14">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">int</span> <span class="nf">totient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">totient_array</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">totient</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">totient_array</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-14">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 1 2 2 4 2 6 4 6 4 
0 1 1 2 2 4 2 6 4 6 4 
</code></pre></div></div>

<h2 id="更新履歴-5">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/16</td>
      <td style="text-align: left">オイラーのφ関数を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-高速フーリエ変換-">🔴 高速フーリエ変換 🔴</h1>

<p>クラスで実装されているが、実行するときはconvolutionを呼び出せばいい</p>

<p>多項式に見立てたvectorを\(2\)つ与えると、それらに対し高速フーリエ変換を用いた畳み込み演算を行い一つの多項式にし、vectorとして返す</p>

<p>\(\{1,2,3\}*\{1,3,5\}=\{1,5,14,19,15\}\)といった調子</p>

<p>実装上doubleを経由しているので誤差死が怖い</p>

<p>計算量は\(N=max(\vert A \vert,\vert B\vert)\)として、\(Ο(NlogN)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/fast%20Fourier%20transform.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">fast_Fourier_transform</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">PI</span><span class="o">=</span><span class="mf">3.14159265358979</span><span class="p">;</span> 
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">DFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A0</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">A1</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">iA0</span><span class="p">,</span><span class="n">iA1</span><span class="p">,</span><span class="n">iA</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">A0</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">A1</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">iA0</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>
        <span class="n">iA1</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">ith_zeta</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">N</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">N</span><span class="p">));</span>
            <span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA0</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span> <span class="n">ith_zeta</span><span class="o">*</span><span class="n">iA1</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">iA</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">iDFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">iA</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">iA</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">dA</span><span class="p">,</span><span class="n">rA</span><span class="p">;</span>
        <span class="n">dA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">iA</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">rA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">dA</span><span class="p">[(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">N</span><span class="p">]);</span>
            <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">rA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">convolution</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">deg</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="n">deg</span><span class="p">){</span><span class="n">N</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;}</span>
        <span class="n">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span><span class="n">B</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">dC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">dA</span><span class="p">,</span><span class="n">iA</span><span class="p">,</span><span class="n">dB</span><span class="p">,</span><span class="n">iB</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">dA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">dB</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">iA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">dA</span><span class="p">);</span><span class="n">iB</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">dB</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">iB</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">dC</span><span class="o">=</span><span class="n">iDFT</span><span class="p">(</span><span class="n">iC</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">dC</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="o">+</span><span class="n">dC</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">C</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deg</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-15">使用例</h2>
<hr />

<h3 id="実行コード-15">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">fast_Fourier_transform</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">fast_Fourier_transform</span> <span class="n">FFT</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="n">C</span><span class="p">;</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-15">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 5 14 19 15 
</code></pre></div></div>

<h2 id="更新履歴-6">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">バグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">高速フーリエ変換を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-数論変換-">🔴 数論変換 🔴</h1>

<p>整数環FFTとも</p>

<p>基本的には<a href="./fft">FFT</a>と同じだが、あちらが実数を使って計算するのに対しこちらは有理数を素数で割った余りを使って計算する</p>

<p>誤差がないというメリットがあるが、\(MOD\)素数より大きい整数を扱えないというデメリットがある</p>

<p>ここで用いる素数は、\(P-1\)が素因数に\(2\)を多く含むような\(P\)であることが望ましい(例えばNTTでよく使われる\(998244353\)は\(119 \cdot 2^{23}+1\)である)</p>

<p>計算量は\(N=max(\vert A \vert,\vert B \vert)\)として、\(Ο(NlogNlogMOD)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/number%20theoretic%20transform.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">number_theoretic_transform</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">998244353</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">119</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">pri_root</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="c1">//MOD=k*2^n+1</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">BE</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">DFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A0</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">A1</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">iA0</span><span class="p">,</span><span class="n">iA1</span><span class="p">,</span><span class="n">iA</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">A0</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">A1</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">iA0</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>
        <span class="n">iA1</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">omega</span><span class="o">=</span><span class="n">BE</span><span class="p">(</span><span class="n">pri_root</span><span class="p">,</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">ith_zeta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA0</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span> <span class="n">ith_zeta</span><span class="o">*</span><span class="n">iA1</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="n">ith_zeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ith_zeta</span><span class="o">*</span><span class="n">omega</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">iA</span><span class="p">;</span>
    <span class="p">}</span>
     
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">iDFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">iA</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">iA</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N_inverse</span> <span class="o">=</span> <span class="n">BE</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">dA</span><span class="p">,</span><span class="n">rA</span><span class="p">;</span>
        <span class="n">dA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">iA</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">rA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">dA</span><span class="p">[(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">N</span><span class="p">]);</span>
            <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">((</span><span class="n">rA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">N_inverse</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    <span class="p">}</span>
    
    
    <span class="nl">public:</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">convolution</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">deg</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="n">deg</span><span class="p">){</span><span class="n">N</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;}</span>
        <span class="n">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span><span class="n">B</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iA</span><span class="p">,</span><span class="n">iB</span><span class="p">;</span>
        <span class="n">iA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A</span><span class="p">);</span><span class="n">iB</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">iB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">C</span><span class="o">=</span><span class="n">iDFT</span><span class="p">(</span><span class="n">iC</span><span class="p">);</span>
        <span class="n">C</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deg</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-16">使用例</h2>
<hr />

<h3 id="実行コード-16">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">number_theoretic_transform</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">number_theoretic_transform</span> <span class="n">NTT</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="n">C</span><span class="p">;</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">NTT</span><span class="p">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-16">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 5 14 19 15 
</code></pre></div></div>

<h2 id="更新履歴-7">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例を追加/vectorをstd::vectorに変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">数論変換を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-任意mod二項係数-">🔴 任意mod二項係数 🔴</h1>

<p>計算量の異なる \(2\) つのコードがある</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/composite%20binomial%20coefficient.cpp">github</a></p>

<ul>
  <li><a href="#その１">その１</a>
    <ul>
      <li>\(n,r \leq 10^{18}, mod \leq 10^6\) 程度の場合に計算できる</li>
    </ul>
  </li>
  <li><a href="#その２">その２</a>
    <ul>
      <li>\(n,r \leq 10^6, mod \leq 10^9\) 程度の場合に計算できる</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="その１">その１</h2>

<p>init</p>
<ul>
  <li>mod \(M\)を与えると、combを実行するのに必要な数値を前計算する</li>
  <li>計算量は \(M\) の素因数分解を \(\prod_{i=1}^{\omega(M)}{ {p_i}^{e_i}}\) とすると \(Ο( \sum_{i=1}^{\omega(M)}{ {p_i}^{e_i}} + \sqrt{M})\)
    <ul>
      <li>\(\omega(m)\) は \(m\) の素因数の個数、\(m \leq 10^9\) のとき \(\omega(m) \leq 10\)</li>
    </ul>
  </li>
</ul>

<p>composite_binomial_coefficient_1</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>comb</p>
<ul>
  <li>整数\(n,r\)を与えると、\(\frac{n!}{r!(n-r)!}\)を\(M\)で割った余りを返す</li>
  <li>extensionはないため、\(n\) にinitで与えた \(N\) より大きい値を与えた場合の挙動は保証しない</li>
  <li>計算量は\(Ο( (\log n + \log M) \omega(M) )\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">composite_binomial_coefficient_1</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Mod</span><span class="p">;</span>    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">fact</span><span class="p">,</span><span class="n">factinv</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">bezout</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">D</span><span class="p">.</span><span class="n">first</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="nl">public:</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>

        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>

        <span class="c1">//Mを素因数分解する</span>
        <span class="c1">//Pは{素数,個数,素数^個数}</span>
        <span class="n">P</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">m</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">e</span><span class="o">++</span><span class="p">;</span>
                <span class="n">m</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
                <span class="n">v</span> <span class="o">*=</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">i</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">});</span>
        <span class="p">}</span>

        <span class="c1">//用いる素数pについて、(x!)_p := (1~xでpと互いに素なものの積)を求める</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]).</span><span class="n">first</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
            
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
                <span class="k">if</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">composite_binomial_coefficient_1</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">mod</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span> <span class="o">||</span> <span class="n">Mod</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">;</span>

        <span class="c1">//各p^qについてnCr mod p^qを求めてLにまとめる</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">pq</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>

            <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">R</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">N</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nown</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">K</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nowk</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nowr</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">long</span> <span class="kt">long</span> <span class="n">e0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">p</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">p</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">p</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">e0</span> <span class="o">+=</span> <span class="n">nown</span><span class="p">;</span>
                <span class="n">e0</span> <span class="o">-=</span> <span class="n">nowk</span><span class="p">;</span>
                <span class="n">e0</span> <span class="o">-=</span> <span class="n">nowr</span><span class="p">;</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">pq</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">pq</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">pq</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">e1</span> <span class="o">+=</span> <span class="n">nown</span><span class="p">;</span>
                <span class="n">e1</span> <span class="o">-=</span> <span class="n">nowk</span><span class="p">;</span>
                <span class="n">e1</span> <span class="o">-=</span> <span class="n">nowr</span><span class="p">;</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
            
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">((</span><span class="n">p</span><span class="o">!=</span><span class="mi">2</span> <span class="o">||</span> <span class="n">q</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">e1</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">pq</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">N</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">N</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">K</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">e0</span><span class="p">);</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">T</span><span class="p">,</span><span class="n">pq</span><span class="p">};</span>
        <span class="p">}</span>

        <span class="c1">//中国剰余定理を用いて復元する</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">q</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(((</span><span class="n">C</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">*</span><span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="n">C</span><span class="p">.</span><span class="n">first</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="n">C</span><span class="p">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">q</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">C</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="使用例-17">使用例</h3>
<hr />

<h4 id="実行コード-17">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">composite_binomial_coefficient_1</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"10で割ったあまり"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
    <span class="n">composite_binomial_coefficient_1</span> <span class="n">CBC</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"もとの値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">composite_binomial_coefficient_1</span> <span class="n">CBC_origin</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC_origin</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-17">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10で割ったあまり
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 0 0 5 1 
1 6 5 0 5 6 1 
1 7 1 5 5 1 7 1 
1 8 8 6 0 6 8 8 1 

もとの値
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 10 10 5 1 
1 6 15 20 15 6 1 
1 7 21 35 35 21 7 1 
1 8 28 56 70 56 28 8 1 

</code></pre></div></div>

<h3 id="更新履歴-8">更新履歴</h3>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">任意mod二項係数を追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://judge.yosupo.jp/problem/binomial_coefficient">Library Checker</a></td>
      <td style="text-align: left"><a href="https://judge.yosupo.jp/submission/130133">提出</a></td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="その２">その２</h2>

<p>init</p>
<ul>
  <li>整数\(N\)とmod \(M\)を与えると、combを実行するのに必要な数値を前計算する</li>
  <li>計算量は \(Ο(N \log N + N \omega(M) + \sqrt{M})\)
    <ul>
      <li>\(\omega(m)\) は \(m\) の素因数の個数、\(m \leq 10^9\) のとき \(\omega(m) \leq 10\)
<!-- √M + Nω(M) + Ω(N!) , もっとタイトな評価ができそう --></li>
    </ul>
  </li>
</ul>

<p>composite_binomial_coefficient_2</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>comb</p>
<ul>
  <li>整数\(n,r\)を与えると、\(\frac{n!}{r!(n-r)!}\)を\(M\)で割った余りを返す</li>
  <li>extensionはないため、\(n\) にinitで与えた \(N\) より大きい値を与えた場合の挙動は保証しない</li>
  <li>計算量は\(Ο(\log M + \omega(M) )\)
    <ul>
      <li>特に、 \(n,r\) に依存しない</li>
    </ul>
  </li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">composite_binomial_coefficient_2</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">sze</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Mod</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span><span class="n">prime</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">index</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factPri</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">factRel</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">power</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">bezout</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">D</span><span class="p">.</span><span class="n">first</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="nl">public:</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>

        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">M</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
        
        <span class="c1">//1~Nの非自明な約数を求める</span>
        <span class="n">d</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">d</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">index</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">index</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">index</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
                <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">N</span> <span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">d</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//法が含む素数のリストを求める</span>
        <span class="n">P</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">M</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">e</span><span class="o">++</span><span class="p">;</span>
                <span class="n">M</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">)</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
                <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">)</span><span class="n">index</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
            <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">//k!について、Mと互いに素である部分とそうでない部分に分けてそれぞれ求める</span>
        <span class="n">factPri</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">factPri</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">factPri</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factRel</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
            <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>

            <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>

            <span class="kt">long</span> <span class="kt">long</span> <span class="n">now</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">now</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
                <span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">now</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="n">p</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">now</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//p^0,p^1,...,p^(N/p)を前計算する</span>
        <span class="n">power</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="n">composite_binomial_coefficient_2</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Mod</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">factPri</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="n">Mod</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">m</span><span class="o">+=</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">],</span><span class="n">Mod</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">m</span><span class="o">+=</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="n">factRel</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">factRel</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">factRel</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="n">assert</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">e</span><span class="p">])</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">};</span>
</code></pre></div></div>

<h3 id="使用例-18">使用例</h3>
<hr />

<h4 id="実行コード-18">実行コード</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">composite_binomial_coefficient_2</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"10で割ったあまり"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
    <span class="n">composite_binomial_coefficient_2</span> <span class="n">CBC</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"もとの値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">composite_binomial_coefficient_2</span> <span class="n">CBC_origin</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC_origin</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="出力-18">出力</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10で割ったあまり
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 0 0 5 1 
1 6 5 0 5 6 1 
1 7 1 5 5 1 7 1 
1 8 8 6 0 6 8 8 1 

もとの値
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 10 10 5 1 
1 6 15 20 15 6 1 
1 7 21 35 35 21 7 1 
1 8 28 56 70 56 28 8 1 

</code></pre></div></div>

<h3 id="更新履歴-9">更新履歴</h3>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">任意mod二項係数を追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題-1">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/arc012/tasks/arc012_4">ARC012-D</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/arc012/submissions/39798965">提出</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-二次元配列の回転-">🔴 二次元配列の回転 🔴</h1>

<p>二次元配列\(A\)を与えると、\(A\)を反時計回りに回転させ返す</p>

<p>第二変数を\(true\)にすると時計回りに回転させる</p>

<p>もし\(A[i]\)の長さが揃っていない場合は最も長いものに合わせ、足りない部分は第三変数の値(デフォルトは\(0\))で埋める</p>

<p>計算量は配列を\(N\)行\(M\)列として\(Ο(NM)\)</p>

<p><a href="">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">bool</span> <span class="n">clockwise</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="kt">char</span> <span class="n">leading</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    
    <span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">M</span><span class="p">,(</span><span class="kt">int</span><span class="p">)</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">());</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">B</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">leading</span><span class="p">));</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">clockwise</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">B</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">B</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-19">使用例</h2>
<hr />

<h3 id="実行コード-19">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">bool</span> <span class="n">clockwise</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="kt">char</span> <span class="n">leading</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span><span class="p">{</span>
        <span class="p">{</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">},</span>
        <span class="p">{</span><span class="sc">'d'</span><span class="p">,</span><span class="sc">'e'</span><span class="p">,</span><span class="sc">'f'</span><span class="p">},</span>
        <span class="p">{</span><span class="sc">'g'</span><span class="p">,</span><span class="sc">'h'</span><span class="p">,</span><span class="sc">'i'</span><span class="p">}</span>
    <span class="p">};</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"回転なし"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"反時計回り"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">counter</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">counter</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">counter</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">clockwise</span> <span class="o">=</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"時計回り"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">clockwise</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">clockwise</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">clockwise</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-19">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>回転なし
a b c 
d e f 
g h i 

反時計回り
c f i 
b e h 
a d g 

時計回り
g d a 
h e b 
i f c
</code></pre></div></div>

<h2 id="更新履歴-10">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/09/12</td>
      <td style="text-align: left">二次元配列の回転を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ランレングス圧縮-">🔴 ランレングス圧縮 🔴</h1>

<p>文字列\(S\)を与えると、\(S\)をランレングス圧縮(連長圧縮)して返す</p>

<p>ランレングス圧縮とは、文字列を「文字と、それがいくつ続くか」の組に変換するものである
ちなみに可逆変換</p>

<p>計算量は\(Ο(\vert S \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/runlength%20encode.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">});</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">R</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">second</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-20">使用例</h2>
<hr />

<h3 id="実行コード-20">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span> <span class="o">=</span> <span class="s">"abbcccddeeeacddd"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">R</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-20">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a 1
b 2
c 3
d 2
e 3
a 1
c 1
d 3
</code></pre></div></div>

<h2 id="更新履歴-11">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/07/10</td>
      <td style="text-align: left">ランレングス圧縮を追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題-2">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc259/tasks/abc259_c">ABC259-C</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc259/submissions/33129519">提出</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-偏角ソート-">🔴 偏角ソート 🔴</h1>

<p>数列\(A\)を与えると、以下の並べ方で\(A\)をソートして返す
基準を第二変数\(d\)(デフォルトでは\((1,0)\))で定めることもできる</p>

<ul>
  <li>偏角(のうち、\([\arg(d),\arg(d)+2\pi)\)であるもの)が小さい順に並べる</li>
  <li>それが同じ場合、絶対値が小さい順に並べる</li>
  <li>\((0,0)\)が含まれる場合assertして停止する</li>
</ul>

<p>計算量は\(Ο(\vert A \vert log \vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/arg%20sort.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">d</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">gcd</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
    <span class="n">d</span><span class="p">.</span><span class="n">first</span><span class="o">/=</span><span class="n">g</span><span class="p">;</span><span class="n">d</span><span class="p">.</span><span class="n">second</span><span class="o">/=</span><span class="n">g</span><span class="p">;</span>
    <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">A</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">){</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">!=</span><span class="n">b</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">&lt;</span><span class="n">b</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">));</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
           <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">d</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">B</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-21">使用例</h2>
<hr />

<h3 id="実行コード-21">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}){</span><span class="cm">/*省略*/</span><span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">//Aを(1,0)を基準にソート</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span> 
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//Aを(-1,1)を基準にソート</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">A</span><span class="p">,{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span> 
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="出力-21">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(3,0) (2,1) (1,2) (0,3) (-1,2) (-2,1) (-3,0) (-2,-1) (-1,-2) (0,-3) (1,-2) (2,-1) 
(-2,1) (-3,0) (-2,-1) (-1,-2) (0,-3) (1,-2) (2,-1) (3,0) (2,1) (1,2) (0,3) (-1,2) 
</code></pre></div></div>

<h2 id="更新履歴-12">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">バグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/10/31</td>
      <td style="text-align: left">偏角ソートを追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-反復写像-">🔴 反復写像 🔴</h1>

<p>init</p>
<ul>
  <li>数列\(F\)を与えると、すべての整数 \(x (0 \leq x &lt; \vert F \vert)\) について \(f(x) = F[x]\) となるように関数 \(f\) を設定する</li>
  <li>計算量は\(N=\vert F \vert\)とし、\(Ο(N)\)</li>
</ul>

<p>iterated_function</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>solve</p>
<ul>
  <li>整数 \(x\) であって\(0 \leq x &lt; N\) を満たすようなものと非負整数 \(k\) を与えると、\(\overbrace{f(f(\cdots f}^{k}(x)))\) を求め、返す</li>
  <li>もし\(k = 0\)なら\(x\)そのものを返す</li>
  <li>範囲外なら\(-1\)を返す</li>
  <li>計算量は\(Ο(N \log k)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/iterated%20function.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">iterated_function</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">N</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">){</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">64</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
    <span class="p">}</span>

    <span class="n">iterated_function</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span> <span class="o">||</span> <span class="n">k</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;(</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">((</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">y</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-22">使用例</h2>
<hr />

<h3 id="実行コード-22">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">iterated_function</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">iterated_function</span> <span class="n">func</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0からk回辿ったときの頂点"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;=</span><span class="mi">15</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">func</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"各頂点から3回辿ったときの頂点"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">func</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-22">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0からk回辿ったときの頂点
0 1 2 3 4 5 2 3 4 5 2 3 4 5 2 3 

各頂点から3回辿ったときの頂点
3 4 5 2 3 4 
</code></pre></div></div>

<h2 id="更新履歴-13">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/07/03</td>
      <td style="text-align: left">反復写像を追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題-3">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc167/tasks/abc167_d">ABC167-D</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc167/submissions/32945330">提出</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-スライド最小値-">🔴 スライド最小値 🔴</h1>

<p>数列\(A\)と整数\(K\)を与えると、以下の数式を満たす要素数が\(\vert A \vert -K+1\)の数列\(R\)を構成し、返す</p>

\[R_i = min(A_i , A_{i+1} , ... , A_{i+K-1})\]

<p>計算量は\(O(\vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/slide%20minimum.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">int</span> <span class="n">K</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">D</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">A</span><span class="p">[</span><span class="n">D</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span><span class="o">&gt;=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span><span class="n">D</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();}</span>
        <span class="n">D</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">D</span><span class="p">.</span><span class="n">front</span><span class="p">()]);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">==</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">D</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-23">使用例</h2>
<hr />

<h3 id="実行コード-23">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">int</span> <span class="n">K</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    
    <span class="n">B</span> <span class="o">=</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">K</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-23">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 1 1 1 2 2 2 3 3 3 5 7 7 3 2 2 
</code></pre></div></div>

<h2 id="更新履歴-14">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/23</td>
      <td style="text-align: left">スライド最小値を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-座標圧縮-">🔴 座標圧縮 🔴</h1>

<p>init</p>
<ul>
  <li>数列\(A\)を与えると、クラスを\(A\)で初期化する</li>
  <li>このとき、\(A\)の全ての\(2\)つの要素について大小関係が維持され、かつindexの最大値が最小になるように\(A\)の各要素にindexという非負整数が割り振られる</li>
  <li>計算量は\(N=\vert A \vert\)とし、\(Ο(NlogN)\)</li>
</ul>

<p>compress</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>size</p>
<ul>
  <li>initで与えられた数列の中に含まれる値の種類数を返す</li>
  <li>計算量は\(Ο(1)\)</li>
</ul>

<p>index</p>
<ul>
  <li>値を与えると、その値に対応するindexを返す</li>
  <li>もし数列に存在しない値が与えられたら、数列に存在する値の中で、与えられた値より小さい最大の値についてのindexを返す(つまり、小さい値に寄せる)</li>
  <li>もし列のいかなる値よりも小さければ\(-1\)を返す</li>
  <li>計算量はinitの\(N\)を用いて、\(Ο(logN)\)</li>
</ul>

<p>value</p>
<ul>
  <li>indexを与えると値を返す</li>
  <li>範囲外なら\(0\)を返す</li>
  <li>計算量は\(Ο(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/coordinate%20compression.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">compress</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">E</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="n">E</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">sort</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">A</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]){</span>
                <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">compress</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">size</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">value</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
            <span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">index</span><span class="p">(</span><span class="kt">int</span> <span class="n">X</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">upper_bound</span><span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">E</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">X</span><span class="p">))</span><span class="o">-</span><span class="n">E</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-24">使用例</h2>
<hr />

<h3 id="実行コード-24">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">compress</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">};</span>
    <span class="n">compress</span> <span class="n">zaatsu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"uniqueな要素の個数"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Aの各要素に対応する数"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0~7に対応する要素"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">zaatsu</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-24">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uniqueな要素の個数
8

Aの各要素に対応する数
0 1 2 3 4 5 6 7 

0~7に対応する要素
1 2 4 8 16 32 64 128 
</code></pre></div></div>

<h2 id="更新履歴-15">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/05/20</td>
      <td style="text-align: left">mapで処理しvectorで返す形式から、class化し二分探索を行う形式に変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">座標圧縮を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-最長増加部分列-">🔴 最長増加部分列 🔴</h1>

<p>数列\(A\)を与えると、\(A\)の最長増加部分列の長さを求め、long longで返す</p>

<p>計算量は\(Ο(\vert A \vert log \vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/longest%20increasing%20subsequence.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">LIS</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">pos</span><span class="o">=</span><span class="n">distance</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">D</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="n">D</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
            <span class="n">D</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">D</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">D</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-25">使用例</h2>
<hr />

<h3 id="実行コード-25">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">LIS</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LIS</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LIS</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-25">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3
2
</code></pre></div></div>

<h2 id="更新履歴-16">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">最長増加部分列を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-moのアルゴリズム-">🔴 Moのアルゴリズム 🔴</h1>

<p>すもももももももものうち</p>

<p>いくつかの半開区間 \([l_i,r_i)\) についての答えを高速に求める
\([l,r)\) での答えがわかっているとき、隣接する区間 \([l-1,r),[l+1,r),[l,r-1),[l,r+1)\) についての答えが高速にわかる場合に有効</p>

<p>第一引数に区間全体の長さ \(N\) 、第二引数にクエリの数 \(Q\) 、第三引数にクエリのリスト、そして第四～第七引数にはそれぞれ</p>
<ul>
  <li>\([l,r)\) の答えから \([l-1,r)\) の答えを求める関数</li>
  <li>\([l,r)\) の答えから \([l+1,r)\) の答えを求める関数</li>
  <li>\([l,r)\) の答えから \([l,r-1)\) の答えを求める関数</li>
  <li>\([l,r)\) の答えから \([l,r+1)\) の答えを求める関数</li>
</ul>

<p>を与えると、各クエリに対しての答えをvectorで返す</p>

<p>計算量は第四～第七引数で与えた関数の計算量を \(f\) とすると \(Ο(Q \log Q + N \sqrt{Q} f)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/mos-algorithm.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Mo</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">X</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">rQ</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">index</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">block</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Ans</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">comp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">A</span><span class="p">.</span><span class="n">first</span><span class="p">]</span><span class="o">!=</span><span class="n">block</span><span class="p">[</span><span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">]){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">A</span><span class="p">.</span><span class="n">first</span><span class="p">]</span><span class="o">&lt;</span><span class="n">block</span><span class="p">[</span><span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="n">B</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">index</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">index</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

    <span class="n">rQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">((</span><span class="n">rQ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rQ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">q</span><span class="p">)</span><span class="n">rQ</span><span class="o">++</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">rQ</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">now</span> <span class="o">+=</span> <span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="n">rQ</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">rQ</span><span class="p">);</span>
        <span class="n">block</span><span class="p">[</span><span class="n">now</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">Y</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="n">e</span><span class="o">:</span><span class="n">index</span><span class="p">){</span>
        <span class="n">Y</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
        <span class="n">now</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">Y</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">auto</span> <span class="n">a</span><span class="p">,</span> <span class="k">auto</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">comp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);});</span>

    <span class="kt">int</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        
        <span class="k">while</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">){</span>
            <span class="n">lm</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">L</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">){</span>
            <span class="n">rp</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">R</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">L</span> <span class="o">&lt;</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">){</span>
            <span class="n">lp</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">L</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">){</span>
            <span class="n">rm</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">R</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">:</span><span class="n">index</span><span class="p">[</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">]]){</span>
            <span class="n">Ans</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Result</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="k">return</span> <span class="n">Ans</span><span class="p">;</span>

    <span class="c1">//lm(i): [i,r)を[i-1,r)にする</span>
    <span class="c1">//lp(i): [i,r)を[i+1,r)にする</span>
    <span class="c1">//rm(i): [i,r)を[i,r-1)にする</span>
    <span class="c1">//rp(i): [i,r)を[i,r+1)にする</span>

<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-26">使用例</h2>
<hr />

<p><br />
\(A = (1,2,3,4,5)\) の \([l,r)\) の和を求める</p>

<p>これは \([l,r)\) の和がわかっていれば \([l-1,r),[l+1,r),[l,r-1),[l,r+1)\) の和が \(O(1)\) でわかる<br />
例えば \([1,3)\) の和が \(A_1 + A_2 = 2 + 3 = 5\) であることがわかっていれば \([1,4)\) の和は \(5 + A_3 = 5 + 4 = 9\) であることがわかる</p>

<h3 id="実行コード-26">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Mo</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">X</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">LR</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
    <span class="p">};</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">};</span>


    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Ans</span> <span class="o">=</span> <span class="n">Mo</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">LR</span><span class="p">,</span><span class="n">lm</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">rm</span><span class="p">,</span><span class="n">rp</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"["</span> <span class="o">&lt;&lt;</span> <span class="n">LR</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">LR</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")  "</span> <span class="o">&lt;&lt;</span> <span class="n">Ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-26">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0,1)  1
[0,2)  3
[0,3)  6
[0,4)  10
[0,5)  15
[1,2)  2
[1,3)  5
[1,4)  9
[1,5)  14
[2,3)  3
[2,4)  7
[2,5)  12
[3,4)  4
[3,5)  9
[4,5)  5

</code></pre></div></div>

<h2 id="更新履歴-17">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/13</td>
      <td style="text-align: left">Moのアルゴリズムを追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題-4">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc293/tasks/abc293_g">ABC293-G</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc293/submissions/39690323">提出</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ローリングハッシュ-">🔴 ローリングハッシュ 🔴</h1>

<p>MOD \(2^{61}-1\)と\(2\)基底を採用しています　<a href="https://trap.jp/post/900/">例の記事</a>はいったい･･･<br />
基底はコード中のBaseを直にいじれば変更できます ここサポートした方がいいのかな？</p>

<p>init</p>
<ul>
  <li><del>文字列</del> long longのvector \(S\) を与えると、前計算として\(S\)をハッシュする他、getの計算で使用する数値を計算する</li>
  <li>計算量は基底の数を\(b\)として、\(Ο(b\vert S \vert)\)</li>
</ul>

<p>rollinghash</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>get</p>
<ul>
  <li>半開区間\([l,r)\)を与えると、\(S\)の\([l,r)\)文字目のハッシュ値を返す</li>
  <li>計算量は基底の数を\(b\)として、\(Ο(b)\)</li>
</ul>

<p>instant</p>
<ul>
  <li><del>文字列</del> long longのvector \(P\)を与えると、initに与えた\(S\)とは関係なく\(P\)のハッシュ値を計算し返す</li>
  <li>ただ返すだけで、initで揃えた情報を変更することはない</li>
  <li>計算量は基底の数を\(b\)として、\(Ο(b\vert P \vert)\)</li>
</ul>

<p>connect</p>
<ul>
  <li><del>文字列</del> long longのvector \(P,Q\) のハッシュ結果と列の長さを与えると、initに与えた\(S\)とは関係なく\(P,Q\)の結合vector\(P+Q\)のハッシュ値を計算し返す</li>
  <li>ただ返すだけで、initで揃えた情報を変更することはない</li>
  <li>計算量は基底の数を\(b\)、\(P\)の長さを\(p\)として、\(Ο(b \log{p})\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/rollinghash.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">rollinghash</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span> <span class="o">&lt;&lt;</span> <span class="mi">61</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Base</span> <span class="o">=</span> <span class="p">{</span><span class="mi">12345</span><span class="p">,</span><span class="mi">10000000</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">BaseInv</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">BaseInvExp</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">product</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">b2</span> <span class="o">=</span> <span class="n">b</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">s</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a1</span><span class="o">*</span><span class="n">b1</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">b2</span> <span class="o">+</span> <span class="n">b1</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s1</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">s2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">b2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">H</span><span class="p">,</span><span class="n">Hsum</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">cs</span><span class="p">){</span>
        <span class="n">S</span><span class="o">=</span><span class="n">cs</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        
        <span class="n">BaseInv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">BaseInvExp</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">H</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">Hsum</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="c1">//逆元</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BaseInv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">power</span><span class="p">(</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mod</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">BaseInv</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//本体</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">);</span>
                <span class="n">b</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//累積和</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">rollinghash</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">C</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">-</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="n">mod</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="n">g</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]);</span>
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">instant</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">))</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">connect</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">ps</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">qs</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">power</span><span class="p">(</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ps</span><span class="p">))</span><span class="o">+</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">qs</span><span class="o">==</span><span class="n">qs</span><span class="p">);</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-27">使用例</h2>
<hr />

<h3 id="実行コード-27">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">rollinghash</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">rollinghash</span> <span class="n">rolihash</span><span class="p">({</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">,</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">の[0,2)文字目、つまり</span><span class="se">\"</span><span class="s">ab</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">の[1,4)文字目、つまり</span><span class="se">\"</span><span class="s">bca</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">の[3,5)文字目、つまり</span><span class="se">\"</span><span class="s">ab</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">c</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">bc</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">instant</span><span class="p">({</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">d</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">a</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">instant</span><span class="p">({</span><span class="sc">'a'</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">bc</span><span class="se">\"</span><span class="s">と</span><span class="se">\"</span><span class="s">a</span><span class="se">\"</span><span class="s">の結合、つまり</span><span class="se">\"</span><span class="s">bca</span><span class="se">\"</span><span class="s">のハッシュ値"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-27">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"abcab"の[0,2)文字目、つまり"ab"のハッシュ値
2444507 1980000197 

"abcab"の[1,4)文字目、つまり"bca"のハッシュ値
30025064778 19700001990000198 

"abcab"の[3,5)文字目、つまり"ab"のハッシュ値
2444507 1980000197 

"bc"のハッシュ値
2456853 1990000198 

"a"のハッシュ値
197 197 

"bc"と"a"の結合、つまり"bca"のハッシュ値
30025064778 19700001990000198 
</code></pre></div></div>

<h2 id="更新履歴-18">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/25</td>
      <td style="text-align: left">connectを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/25</td>
      <td style="text-align: left">ハッシュ対象をstringからvector<long long="">に変更</long></td>
    </tr>
    <tr>
      <td style="text-align: center">2022/06/26</td>
      <td style="text-align: left">constexprによる最適化を実行</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/08/31</td>
      <td style="text-align: left">instantを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/01</td>
      <td style="text-align: left">ローリングハッシュを追加</td>
    </tr>
  </tbody>
</table>

<h2 id="確認した問題-5">確認した問題</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">問題</th>
      <th style="text-align: left">提出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc141/tasks/abc141_e">ABC141-E</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc141/submissions/39997036">提出</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ダイクストラ法-">🔴 ダイクストラ法 🔴</h1>

<p>init</p>
<ul>
  <li>無向グラフを、頂点数\(N\)と、辺の始点と終点とコストを表現したpair&lt;pair&lt;int,int&gt;,long long&gt;のvectorとして与える。</li>
  <li>すると、グラフをsolve()が扱えるようになる</li>
  <li>多始点などで何回も回す場合、initの実行は\(1\)回でよい</li>
  <li>計算量は\(Ο(\vert E \vert)\)</li>
</ul>

<p>Dijkstra</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>solve</p>
<ul>
  <li>initでできたグラフに対し、与えられた\(s\)を始点としてダイクストラ法を実行する</li>
  <li>得られた最小コストを要素数が\(V\)のvectorとして返す</li>
  <li>計算量は\(Ο((E+V)logV)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/Dijkstra.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dijkstra</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">P</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;&gt;</span> <span class="n">que</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//頂点数を決定する</span>
        <span class="n">V</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        
        <span class="c1">//辺集合を扱いやすい形式に変換する</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">from</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">cost</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">cost</span><span class="p">,</span><span class="n">to</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">Dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="c1">//INFで初期化する</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">INF</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">});</span>
        <span class="c1">//queは{cost,to}をコストが小さい順に出す</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="n">P</span> <span class="n">p</span> <span class="o">=</span> <span class="n">que</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
            <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&lt;</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">P</span> <span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">]</span><span class="o">&gt;</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">){</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
                    <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">],</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">});</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-28">使用例</h2>
<hr />

<h3 id="実行コード-28">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Dijkstra</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">Dijkstra</span> <span class="n">dijkstra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">E</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-28">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 3 7 11 
2305843009213693952 0 2 6 10 
</code></pre></div></div>

<h2 id="更新履歴-19">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例、コンストラクタを追加/コメントを削除</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/02/12</td>
      <td style="text-align: left">バグを修正/いくつかの表記変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">ダイクストラ法を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ベルマンフォード法-">🔴 ベルマンフォード法 🔴</h1>

<p>init</p>
<ul>
  <li>無向グラフを、辺の始点と終点とコストを表現したpair&lt;pair&lt;int,int&gt;,long long&gt;のvectorとして与える。</li>
  <li>すると、グラフをsolve()が扱えるようになる</li>
  <li>多始点などで何回も回す場合、initの実行は\(1\)回でよい</li>
  <li>計算量は\(Ο(max(E,V))\)</li>
</ul>

<p>BellmanFord</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>solve</p>
<ul>
  <li>initでできたグラフに対し、与えられた\(s\)を始点としてベルマンフォード法を実行する</li>
  <li>得られた最小コストを要素数が\(V\)のvectorとして返す</li>
  <li>vectorの要素はpair&lt;long long,bool&gt;である　firstは最小コストを表しており、secondがtrueの場合最小コストが存在せずfirstの値は適当</li>
  <li>計算量は\(Ο(VE)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/BellmanFord.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BellmanFord</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">E</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//辺数をもとめる　</span>
        <span class="n">E</span><span class="o">=</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="c1">//頂点数を決定する</span>
        <span class="n">V</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        <span class="n">es</span><span class="o">=</span><span class="n">edge</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">BellmanFord</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="c1">//INFで初期化する</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">INF</span><span class="p">,</span><span class="nb">false</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">].</span><span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
             <span class="kt">bool</span> <span class="n">update</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">P</span> <span class="n">k</span><span class="o">=</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">!=</span><span class="n">INF</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">first</span><span class="o">&gt;</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="n">k</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">first</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="n">k</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">V</span><span class="p">){</span>
                        <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">second</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="n">update</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">update</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-29">使用例</h2>
<hr />

<h3 id="実行コード-29">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">BellmanFord</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">BellmanFord</span> <span class="n">bellmanford</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">E</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">bellmanford</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-INF"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">bellmanford</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-INF"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-29">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 3 7 11 
2305843009213693952 0 2 6 10 
</code></pre></div></div>

<h2 id="更新履歴-20">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">バグを修正/コメントを削除</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">ベルマンフォード法を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-クラスカル法-">🔴 クラスカル法 🔴</h1>

<p>無向グラフを、辺の始点と終点とコストを表現したpair&lt;pair&lt;int,int&gt;,long long&gt;のvectorとして与える。</p>

<p>すると、コストの和が最小になるような全域木を一つ構成し、その木を構成する辺をvectorとして返す</p>

<p>辺がつなぐ\(2\)頂点が連結かどうかを<a href="./unionfind">UnionFind</a>を用いて判定している</p>

<p>計算量は\(Ο(ElogE)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/Kruskal.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Kruskal</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">V</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">;</span>
    
    <span class="kt">bool</span> <span class="n">comp</span><span class="p">(</span><span class="n">P</span> <span class="n">F</span><span class="p">,</span><span class="n">P</span> <span class="n">G</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">F</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="n">G</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//頂点数を決定する</span>
        <span class="n">V</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//辺数をもとめる　</span>
        <span class="n">E</span><span class="o">=</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="c1">//unionfindを初期化する</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//辺をソートして代入しておく</span>
        <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">edge</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">edge</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">P</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span> <span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">comp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);});</span>
        <span class="n">es</span><span class="o">=</span><span class="n">edge</span><span class="p">;</span>
        
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">same</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">)){</span>
                <span class="n">unite</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-30">使用例</h2>
<hr />

<h3 id="実行コード-30">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Kruskal</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">Kruskal</span> <span class="n">kruskal</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">kruskal</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">E</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">K</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-30">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1  1
1 2  2
2 3  4
2 4  8
</code></pre></div></div>

<h2 id="更新履歴-21">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">コメントを削除</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">クラスカル法を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-二部グラフ判定-">🔴 二部グラフ判定 🔴</h1>

<p>無向グラフを、辺の始点と終点を表現したpair&lt;int,int&gt;のvectorとして与える。<br />
すると、sizeが\(max(点の番号)+1\)のvectorが返ってくる。すべての要素は\(0\)または\(1\)である。<br />
これは、与えられたグラフを二部グラフとして表現するとき\(i\)番目の要素は\(0\)と\(1\)どちらに属するかを表している。<br />
また二部グラフでないとき全ての要素は\(0\)である。<br />
計算量は\(Ο(V+E)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/bipartite%20graph.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">E</span> <span class="o">=</span> <span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">E</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="p">{};</span>
    <span class="kt">int</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
        <span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">visited</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
        <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="n">visited</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">==</span><span class="n">R</span><span class="p">[</span><span class="n">q</span><span class="p">]){</span>
                    <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span><span class="k">continue</span><span class="p">;</span>
                <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
                <span class="n">R</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">R</span><span class="p">[</span><span class="n">q</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="使用例-31">使用例</h2>
<hr />

<h3 id="実行コード-31">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span><span class="cm">/*省略*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">;</span>
    
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Es</span> <span class="o">=</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">E</span><span class="p">),</span> <span class="n">Fs</span> <span class="o">=</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Es</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Es</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Fs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Fs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-31">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 0 1 1 
0 0 0 0 0 
</code></pre></div></div>

<h2 id="更新履歴-22">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例を追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">バグを修正/計算量表記を修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/02</td>
      <td style="text-align: left">二部グラフ判定を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-木の直径-">🔴 木の直径 🔴</h1>

<p>木ではない一般的なグラフでも近似解が出るらしいけどチェックしてません(え？)</p>

<p>init</p>
<ul>
  <li>整数\(N\)と頂点数\(N\)の重み付き木を0-indexedのvector&lt;pair&lt;pair&lt;int,int&gt;,long long»で与えると前計算をし、木の直径が計算できるようになる</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>double_sweep</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>vertex</p>
<ul>
  <li>最も距離が大きくなるような頂点対\((u,v)\)を一つ返す</li>
  <li>計算量は\(Ο(1)\)</li>
</ul>

<p>pass</p>
<ul>
  <li>\(u\)と\(v\)の間のパスを返す</li>
  <li>このときvectorの先頭が\(u\)、最後尾が\(v\)になる</li>
  <li>計算量はパスの長さを\(P\)として、\(Ο(P)\)</li>
</ul>

<p>diameter</p>
<ul>
  <li>\(u\)と\(v\)の間のパスの重さを出力する</li>
  <li>計算量はパスの長さを\(P\)として、\(Ο(P)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/double%20sweep.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">double_sweep</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">parent</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">parent_cost</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">diam</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">temp</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">phase</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="n">temp</span><span class="p">){</span>
                <span class="n">V1</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
            <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="n">temp</span><span class="p">){</span>
                <span class="n">V2</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">E</span><span class="o">:</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">!=</span><span class="n">p</span><span class="p">){</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
                    <span class="n">parent_cost</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="n">V1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">V2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        
        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">from</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">cost</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">to</span><span class="p">,</span><span class="n">cost</span><span class="p">});</span>
            <span class="n">G</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">from</span><span class="p">,</span><span class="n">cost</span><span class="p">});</span>
        <span class="p">}</span>
        
        <span class="n">parent</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">parent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">parent_cost</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">parent_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">double_sweep</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vertex</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span><span class="n">V1</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pass</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">V2</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">!=</span><span class="n">V1</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
            <span class="n">diam</span> <span class="o">+=</span> <span class="n">parent_cost</span><span class="p">[</span><span class="n">r</span><span class="p">];</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">r</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">diameter</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">diam</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">pass</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">diam</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-32">使用例</h2>
<hr />

<h3 id="実行コード-32">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">double_sweep</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">;</span>
    
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="mi">16</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">},</span><span class="mi">32</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">},</span><span class="mi">64</span><span class="p">});</span>
    
    <span class="n">double_sweep</span> <span class="n">DS</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    
    
    <span class="c1">//直径の端の頂点は6と7</span>
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">vertex</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//そのパスは6-5-7</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">pass</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//重さの和は96</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">D</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">diameter</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">D</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-32">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6 7
6 5 7 
96
</code></pre></div></div>

<h2 id="更新履歴-23">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/10/15</td>
      <td style="text-align: left">木の直径を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-最小共通祖先-">🔴 最小共通祖先 🔴</h1>

<p>init</p>
<ul>
  <li>整数\(r\)と頂点数\(N\)の木を0-indexedのvector&lt;pair&lt;int,int»で与えると前計算をし、\(r\)を根とする木のLCAが計算できるようになる</li>
  <li>計算量は\(Ο(N \log N)\)</li>
</ul>

<p>lowest_common_ancestor</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>climb</p>
<ul>
  <li>\(u\)と\(k\)を与えると、頂点\(u\)から\(k\)個遡った頂点の番号を返す</li>
  <li>もし根を超えてしまった場合は\(-1\)を返す</li>
  <li>計算量は\(Ο(\log k)\)</li>
</ul>

<p>lca</p>
<ul>
  <li>\(u\)と\(v\)を与えると頂点\(u\)と\(v\)のLCA(最小共通祖先)を返す</li>
  <li>計算量は木の頂点数\(N\)を用いて、\(Ο(\log N)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/lowest%20common%20ancestor.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">lowest_common_ancestor</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">LOG</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">,</span><span class="n">table</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">depth</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">v</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span><span class="p">){</span>
        <span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="o">:</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">!=</span><span class="n">p</span><span class="p">){</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">root</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">LOG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">LOG</span><span class="p">)</span><span class="o">&lt;</span><span class="n">V</span><span class="p">)</span><span class="n">LOG</span><span class="o">++</span><span class="p">;</span>

        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">G</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
            <span class="n">G</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="n">table</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">LOG</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">depth</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">LOG</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]][</span><span class="n">j</span><span class="p">];</span>
                <span class="p">}</span>
                
            <span class="p">}</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    
    <span class="n">lowest_common_ancestor</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">root</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>
    
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">climb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">u</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">u</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">lca</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">u</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">v</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">depth</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">&gt;</span><span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">);</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">climb</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="n">depth</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span><span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">LOG</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]){</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-33">使用例</h2>
<hr />

<h3 id="実行コード-33">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">lowest_common_ancestor</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">;</span>
    
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">});</span>
    
    <span class="c1">//0を根として前計算する</span>
    <span class="n">lowest_common_ancestor</span> <span class="n">LCA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    
    <span class="c1">//頂点6から一つずつ遡ったら6→5→1→0になり、それを超えると-1</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">climb</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//頂点6と頂点7のLCAは5</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//頂点6と頂点1のLCAは1</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//頂点6と頂点3のLCAは0</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-33">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6 5 1 0 -1 
5
1
0
</code></pre></div></div>

<h2 id="更新履歴-24">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/10/10</td>
      <td style="text-align: left">最小共通祖先を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ディニッツ法-">🔴 ディニッツ法 🔴</h1>

<p>Dinicの読み方これでいいのかな</p>

<p>init</p>
<ul>
  <li>整数\(N\)を与えると、頂点を\(N\)個生成しフローの計算に必要なメモリを確保する</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>Dinic</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>add</p>
<ul>
  <li>頂点\(from\)から\(end\)にかけて容量\(cap\)の有向辺を張る</li>
  <li>計算量は\(O(1)\)</li>
</ul>

<p>solve</p>
<ul>
  <li>頂点\(s\)を始点、頂点\(t\)を終点としてフローの最大値を求める</li>
  <li>計算量はinitで与えた頂点の数を\(V\)、addで与えた辺の数を\(E\)として\(Ο(E V^2)\)</li>
  <li>実際はこれよりも高速に動作する</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/dinic.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dinic</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">struct</span> <span class="nc">edge</span><span class="p">{</span>
        <span class="kt">int</span> <span class="n">end</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">cap</span><span class="p">,</span><span class="n">rev</span><span class="p">;</span>
        
    <span class="p">};</span>
    
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">edge</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">level</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">iter</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">Dinic_bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">que</span><span class="p">;</span>
        <span class="n">level</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="n">que</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
            <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">edge</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]</span><span class="o">=</span><span class="n">level</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                    <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Dinic_dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">==</span><span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="n">f</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">i</span><span class="o">=</span><span class="n">iter</span><span class="p">[</span><span class="n">v</span><span class="p">];</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">edge</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">level</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&lt;</span><span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]){</span>
                <span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Dinic_dfs</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="p">));</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">e</span><span class="p">.</span><span class="n">cap</span> <span class="o">-=</span> <span class="n">d</span><span class="p">;</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">][</span><span class="n">e</span><span class="p">.</span><span class="n">rev</span><span class="p">].</span><span class="n">cap</span><span class="o">+=</span><span class="n">d</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">level</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">iter</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">Dinic</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">from</span><span class="p">,</span><span class="kt">int</span> <span class="n">end</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">cap</span><span class="p">){</span>
        <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">edge</span><span class="p">){</span><span class="n">end</span><span class="p">,</span><span class="n">cap</span><span class="p">,(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">G</span><span class="p">[</span><span class="n">end</span><span class="p">].</span><span class="n">size</span><span class="p">()});</span>
        <span class="n">G</span><span class="p">[</span><span class="n">end</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">edge</span><span class="p">){</span><span class="n">from</span><span class="p">,</span><span class="mi">0</span><span class="p">,(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">});</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">flow</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">Dinic_bfs</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">level</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="n">flow</span><span class="p">;}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">iter</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">;</span>
            <span class="k">while</span><span class="p">((</span><span class="n">f</span><span class="o">=</span><span class="n">Dinic_dfs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">INF</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">flow</span><span class="o">+=</span><span class="n">f</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-34">使用例</h2>
<hr />

<h3 id="実行コード-34">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Dinic</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">Dinic</span> <span class="n">dinitz</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    
    <span class="c1">//このグラフでは頂点0から頂点4へは最大で5つ流れる</span>
    <span class="c1">//例えば0-&gt;2-&gt;4に2つ、0-&gt;1-&gt;2-&gt;3-&gt;4に1つ、0-&gt;1-&gt;3-&gt;4に2つなどが考えられる</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">dinitz</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">R</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="出力-34">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5
</code></pre></div></div>

<h2 id="更新履歴-25">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">githubリンクを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">ディニッツ法を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-セグメント木-">🔴 セグメント木 🔴</h1>

<p>単にセグ木と言えばこれを指す、最も単純なセグ木</p>

<p>init</p>
<ul>
  <li>第一引数で整数\(N\)を与えると、要素が\(N\)個入る最小サイズの完全二分木を構成し、すべての要素を単位元で初期化する</li>
  <li>また第二･第三引数でセグ木に乗せる演算とその単位元を与えるとその演算を乗せる</li>
  <li>演算がモノイドでない場合の動作は保証しない</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>segmenttree</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>update</p>
<ul>
  <li>\(k\)番目(0-indexed)の要素を\(a\)で更新し、それが影響するノードを全て更新する</li>
  <li>計算量はinitの\(N\)を用いて、\(Ο(logN)\)</li>
</ul>

<p>query</p>
<ul>
  <li>\([a,b)\)の範囲内にある要素をcalcで計算した結果をlong longで返す</li>
  <li>計算量は\(Ο(log(b-a))\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/segment%20tree.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">segmenttree</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">dat</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">calc</span><span class="p">;</span>
    <span class="n">T</span> <span class="n">identity</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span><span class="p">,</span><span class="n">T</span> <span class="n">Identity</span><span class="p">){</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="n">n</span><span class="o">*=</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">dat</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="n">dat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Identity</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">func</span><span class="p">;</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">segmenttree</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span><span class="p">,</span><span class="n">T</span> <span class="n">Identity</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="n">Identity</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="n">T</span> <span class="n">a</span><span class="p">){</span>
        <span class="n">k</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">dat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="n">dat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">calc</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">dat</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">T</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
        <span class="n">a</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">b</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">L</span><span class="o">=</span> <span class="n">identity</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">identity</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">dat</span><span class="p">[</span><span class="n">a</span><span class="p">]);</span>
                <span class="n">a</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">R</span><span class="p">);</span>
                <span class="n">b</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-35">使用例</h2>
<hr />

<h3 id="実行コード-35">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">segmenttree</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">100000</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="n">segmenttree</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">segtree</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">segtree</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-35">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>123000
123456
3456
450
6
</code></pre></div></div>

<h2 id="更新履歴-26">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/01/30</td>
      <td style="text-align: left">バグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/01/30</td>
      <td style="text-align: left">任意の型に対応</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/10/10</td>
      <td style="text-align: left">バグを修正</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">セグメント木を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-フェニック木-">🔴 フェニック木 🔴</h1>

<p>BIT(Binary Indexed Tree)とも</p>

<p>init</p>
<ul>
  <li>整数\(N\)を与えると、要素が\(N\)個のフェニック木を構成し、すべての要素を\(0\)で初期化する</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>Fenwick_tree</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>add</p>
<ul>
  <li>\(a\)番目(0-indexed)の要素に\(w\)を加算する</li>
  <li>計算量はinitの\(N\)を用いて、\(Ο(log(N))\)</li>
</ul>

<p>sum</p>
<ul>
  <li>\([0,a)\)の範囲内にある要素の和をlong longで返す</li>
  <li>計算量は\(Ο(log(a))\)</li>
</ul>

<p>inversion</p>
<ul>
  <li>数列\(V\)を与えると\(V\)の転倒数を計算し、long longで返す</li>
  <li>この際、initし直すため今までの内容をすべて削除する</li>
  <li>計算量は\(Ο(\vert V \vert log \vert V \vert)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/Fenwick%20tree.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Fenwick_tree</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">BIT</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">w</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">x</span><span class="o">&lt;</span><span class="n">BIT</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">x</span><span class="o">|=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)){</span>
            <span class="n">BIT</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+=</span><span class="n">w</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">BIT</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BIT</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">Fenwick_tree</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">sum</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">+=</span><span class="n">BIT</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">inversion</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">V</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">init</span><span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">add</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">r</span><span class="o">+=</span><span class="n">i</span><span class="o">-</span><span class="n">sum</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-36">使用例</h2>
<hr />

<h3 id="実行コード-36">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Fenwick_tree</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">100000</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">};</span>
    
    <span class="n">Fenwick_tree</span> <span class="n">BIT</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">BIT</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BIT</span><span class="p">.</span><span class="n">sum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BIT</span><span class="p">.</span><span class="n">inversion</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-36">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
100000
120000
123000
123400
123450
123456

3
</code></pre></div></div>

<h2 id="更新履歴-27">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">フェニック木を追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-unionfind-">🔴 UnionFind 🔴</h1>

<p>DSU(disjoint set union)とも</p>

<p>init</p>
<ul>
  <li>整数\(N\)を与えると、頂点を\(N\)個生成し全てを独立にした上で全てのランクを\(0\)にする</li>
  <li>計算量は\(Ο(N)\)</li>
</ul>

<p>unionfind</p>
<ul>
  <li>コンストラクタ。initを呼ぶ</li>
</ul>

<p>root</p>
<ul>
  <li>頂点\(k\)のその時点での根を求める</li>
  <li>と同時に経路圧縮する</li>
  <li>計算量は\(Ο(\alpha (N))\)</li>
</ul>

<p>\(α(x)\)はアッカーマン関数\(Ack(x,x)\)の逆関数</p>

<p>\(Ack(4,4)=2^{2^{2^{65536}}}-3\)から伺えるように、\(\alpha (x)\)は実用上定数(\(4\))倍と見なせるほどに収束が遅い</p>

<p>same</p>
<ul>
  <li>頂点\(p\)と頂点\(q\)がその時点で同じ集合に属しているか(=根が同一か)を調べ、同じならtrue、違うならfalseを返す</li>
  <li>計算量は\(Ο(\alpha (N))\)</li>
</ul>

<p>unite</p>
<ul>
  <li>頂点\(p\)と頂点\(q\)が属してる集合を合併する</li>
  <li>すでに同じ集合に属している場合は無視する</li>
  <li>\(p\)の属する集合のランクが\(q\)のものと同じか大きいとき\(p\)側が根に、そうでないとき\(q\)側が根になる</li>
  <li>計算量は\(Ο(\alpha (N))\)</li>
</ul>

<p>size</p>
<ul>
  <li>頂点\(k\)とその時点で同じ集合に属している頂点の数を返す</li>
  <li>計算量は\(Ο(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/union%20find.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">unionfind</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">size_</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">size_</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">size_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">unionfind</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">size_</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="n">size_</span><span class="p">[</span><span class="n">q</span><span class="p">];</span>
        <span class="n">size_</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">size</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">size_</span><span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">k</span><span class="p">)];</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-37">使用例</h2>
<hr />

<h3 id="実行コード-37">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">unionfind</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">unionfind</span> <span class="n">UF</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">root</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//1と同じ集合に属しているなら1(true)、そうでないなら0(false)</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">same</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//同じ集合に入っている頂点がいくつあるか</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-37">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 1 4 1 4 1 1 4 1 4 1 
1 0 1 0 1 0 1 1 0 1 0 1 
7 1 7 4 7 4 7 7 4 7 4 7 
</code></pre></div></div>

<h2 id="更新履歴-28">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/08/31</td>
      <td style="text-align: left">sizeを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">UnionFindを追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ポテンシャル付きunionfind-">🔴 ポテンシャル付きUnionFind 🔴</h1>

<p>重み付きUnionFindって言ったほうがいいのかな？正直わからない</p>

<p>大体の機能は<a href="./unionfind">UnionFind</a>と同じで違う点は</p>

<p>potential</p>
<ul>
  <li>頂点\(k\)のその時点でのポテンシャルを求める</li>
  <li>計算量は\(Ο(\alpha (N))\)</li>
</ul>

<p>unite</p>
<ul>
  <li>集合を合併する際に、\((Qのポテンシャル)-(Pのポテンシャル)=d\)になるように指定する</li>
  <li>P,Qが同じ集合にある場合にfalseを返す</li>
</ul>

<p>diff</p>
<ul>
  <li>\((Qのポテンシャル)-(Pのポテンシャル)\)を返す</li>
  <li>計算量は\(Ο(\alpha (N))\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/potentialized%20unionfind.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">potentialized_unionfind</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">pot</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">pot</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">potentialized_unionfind</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="n">pot</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pot</span><span class="p">[</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]];</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">potential</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="n">root</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">pot</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span><span class="p">){</span>
        <span class="c1">//pot(Q)-pot(P)=dを満たす</span>
        <span class="n">d</span><span class="o">+=</span><span class="n">potential</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="n">d</span><span class="o">-=</span><span class="n">potential</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">]){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
            <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">pot</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">diff</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">potential</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="n">potential</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="使用例-38">使用例</h2>
<hr />

<h3 id="実行コード-38">実行コード</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">potentialized_unionfind</span><span class="p">{</span><span class="cm">/*省略*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">potentialized_unionfind</span> <span class="n">potUF</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"頂点3と頂点4の結合はできているか"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">c</span> <span class="o">=</span> <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"true"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"false"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"頂点0とのポテンシャルの差は何か"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">potUF</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"頂点2とのポテンシャルの差は何か"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">potUF</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="出力-38">出力</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>頂点3と頂点4の結合はできているか
false

頂点0とのポテンシャルの差は何か
0 1 3 7 11 

頂点2とのポテンシャルの差は何か
-3 -2 0 4 8 
</code></pre></div></div>

<h2 id="更新履歴-29">更新履歴</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">日時</th>
      <th style="text-align: left">内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ライセンスのコメントアウトを変更</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">使用例、コンストラクタを追加</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">ポテンシャル付きUnionFindを追加</td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>


  </body>
</html>
  </div><a class="u-url" href="/library/posts/wild" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/library/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">すくライブラリ</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">すくライブラリ</li><li><a class="u-email" href="mailto:0214sh7@gmail.com">0214sh7@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/0214sh7"><svg class="svg-icon"><use xlink:href="/library/assets/minima-social-icons.svg#github"></use></svg> <span class="username">0214sh7</span></a></li><li><a href="https://www.twitter.com/0214sh7"><svg class="svg-icon"><use xlink:href="/library/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">0214sh7</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
