<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/library/posts/wild" />
<meta property="og:url" content="http://localhost:4000/library/posts/wild" />
<meta property="og:site_name" content="ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="0000-01-01T00:01:58+09:18" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"0000-01-01T00:01:58+09:18","datePublished":"0000-01-01T00:01:58+09:18","headline":"ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/library/posts/wild"},"url":"http://localhost:4000/library/posts/wild"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/library/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/library/feed.xml" title="ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/library/">ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/library/about/">ABOUT</a><a class="page-link" href="/library/license/">LICENSE</a><a class="page-link" href="/library/whatwecan/">ã§ãã‚‹ã“ã¨ä¸€è¦§</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="0000-01-01T00:01:58+09:18" itemprop="datePublished">Jan 1, 0000
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!DOCTYPE html>
<html lang='ja'>
  <head>
    <meta charset="utf-8">
    <title>ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</title>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  
  <body>
    <style>
    pre, code {
        white-space: pre-wrap;
    }
</style>

<h2>æ•°å­¦</h2>
<ul>
  <li><a href="./posts/basic-math">æ•°å­¦è©°ã‚åˆã‚ã›ãƒ‘ãƒƒã‚¯</a></li>
  <li><a href="./posts/binomial-coefficient">ç´ æ•°modäºŒé …ä¿‚æ•°</a></li>
  <li><a href="./posts/sieve">ç´ å› æ•°åˆ†è§£(ç·šå½¢ç¯©)</a></li>
  <li><a href="./posts/bezout-coef">æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•</a></li>
  <li><a href="./posts/convexhull">å‡¸åŒ…</a></li>
  <li><a href="./posts/totient">ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°</a></li>
  <li><a href="./posts/fft">é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›(FFT)</a></li>
  <li><a href="./posts/ntt">æ•°è«–å¤‰æ›(NTT)</a></li>
  <li><a href="./posts/composite-binomial-coefficient">ä»»æ„modäºŒé …ä¿‚æ•°</a></li>
</ul>

<h2>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h2>
<ul>
  <li><a href="./posts/vector2d-rotate">äºŒæ¬¡å…ƒé…åˆ—ã®å›è»¢</a></li>
  <li><a href="./posts/run-length-encode">ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®</a></li>
  <li><a href="./posts/arg-sort">åè§’ã‚½ãƒ¼ãƒˆ</a></li>
  <li><a href="./posts/iterated-function">åå¾©å†™åƒ</a></li>
  <li><a href="./posts/slideminimum">ã‚¹ãƒ©ã‚¤ãƒ‰æœ€å°å€¤</a></li>
  <li><a href="./posts/compress">åº§æ¨™åœ§ç¸®</a></li>
  <li><a href="./posts/lis">æœ€é•·å¢—åŠ éƒ¨åˆ†åˆ—</a></li>
  <li><a href="./posts/mos-algorithm">Moã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a></li>
  <li><a href="./posts/rollinghash">ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒãƒƒã‚·ãƒ¥</a></li>
</ul>

<h2>ã‚°ãƒ©ãƒ•</h2>
<ul>
  <li><a href="./posts/dijkstra">ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•</a></li>
  <li><a href="./posts/bellmanford">ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•</a></li>
  <li><a href="./posts/kruskal">ã‚¯ãƒ©ã‚¹ã‚«ãƒ«æ³•</a></li>
  <li><a href="./posts/bipartite">äºŒéƒ¨ã‚°ãƒ©ãƒ•åˆ¤å®š</a></li>
  <li><a href="./posts/double-sweep">æœ¨ã®ç›´å¾„</a></li>
  <li><a href="./posts/lowest-common-ancestor">æœ€å°å…±é€šç¥–å…ˆ</a></li>
  <li><a href="./posts/dinic">ãƒ‡ã‚£ãƒ‹ãƒƒãƒ„æ³•</a></li>
</ul>

<h2>ãƒ‡ãƒ¼ã‚¿æ§‹é€ </h2>
<ul>
  <li><a href="./posts/segmenttree">ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨</a></li>
  <li><a href="./posts/fenwicktree">ãƒ•ã‚§ãƒ‹ãƒƒã‚¯æœ¨</a></li>
  <li><a href="./posts/unionfind">UnionFind</a></li>
  <li><a href="./posts/pot-unionfind">ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä»˜ãUnionFind</a></li>
</ul>

<hr />
<div style="page-break-after: always;"></div>

<h1 id="-æ•°å­¦è©°ã‚åˆã‚ã›ãƒ‘ãƒƒã‚¯-">ğŸ”´ æ•°å­¦è©°ã‚åˆã‚ã›ãƒ‘ãƒƒã‚¯ ğŸ”´</h1>

<p>å„ªæŸ”ä¸æ–­ãªã‚ãªãŸã«</p>

<p>ã¨ã„ã†ã®ã¯å»ºå‰ã§ã€ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦æ‰±ã†ã»ã©ã§ã¯ãªã„ãŒé‡è¦ãªã‚‚ã®ã‚’ä¸€ç®‡æ‰€ã«é›†ã‚ãŸ</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/basic%20math%20assortment.cpp">github</a></p>

<h1 id="ã‚‚ãã˜">ã‚‚ãã˜</h1>
<ul>
  <li><a href="#å°æ•°ç‚¹ä»¥ä¸‹åˆ‡ã‚Šä¸Šã’å¤©äº•é–¢æ•°">å°æ•°ç‚¹ä»¥ä¸‹åˆ‡ã‚Šä¸Šã’(å¤©äº•é–¢æ•°)</a></li>
  <li><a href="#éšä¹—">éšä¹—</a></li>
  <li><a href="#æœ€å¤§å…¬ç´„æ•°">æœ€å¤§å…¬ç´„æ•°</a></li>
  <li><a href="#æœ€å°å…¬å€æ•°">æœ€å°å…¬å€æ•°</a></li>
  <li><a href="#ç´„æ•°åˆ—æŒ™">ç´„æ•°åˆ—æŒ™</a></li>
  <li><a href="#ç´ æ•°åˆ¤å®š">ç´ æ•°åˆ¤å®š</a></li>
  <li><a href="#ç´ æ•°åˆ—æŒ™">ç´ æ•°åˆ—æŒ™</a></li>
  <li><a href="#ç´ å› æ•°åˆ†è§£">ç´ å› æ•°åˆ†è§£</a></li>
  <li><a href="#ç´¯ä¹—ç¹°ã‚Šè¿”ã—äºŒä¹—æ³•">ç´¯ä¹—(ç¹°ã‚Šè¿”ã—äºŒä¹—æ³•)</a></li>
  <li><a href="#é€†å…ƒç´ æ•°mod">é€†å…ƒ(ç´ æ•°MOD)</a></li>
</ul>

<hr />

<h2 id="å°æ•°ç‚¹ä»¥ä¸‹åˆ‡ã‚Šä¸Šã’å¤©äº•é–¢æ•°">å°æ•°ç‚¹ä»¥ä¸‹åˆ‡ã‚Šä¸Šã’(å¤©äº•é–¢æ•°)</h2>

<ul>
  <li>ã‚ˆãã‚ã‚‹å¤©äº•é–¢æ•°</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(1)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">roundup</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">roundup</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">roundup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 2 3 4 5 6 7 8 9 10 
0 1 1 1 1 2 2 2 2 3 3 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="éšä¹—">éšä¹—</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(x\)ã«å¯¾ã—\(x!\)ã‚’è¨ˆç®—ã™ã‚‹</li>
  <li>\(MOD\)ã‚‚ä¸ãˆã‚‹ã¨ãã‚Œã§å‰²ã£ãŸä½™ã‚Šã‚’ã¨ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(x)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">fact</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">x</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-1">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-1">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">fact</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">fact</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-1">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 1 2 6 24 120 720 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="æœ€å¤§å…¬ç´„æ•°">æœ€å¤§å…¬ç´„æ•°</h2>

<ul>
  <li>ï¼’ã¤ã®å¼•æ•°ã®GCDã‚’æ±‚ã‚ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(O(log(max(a,b)))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">a</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="n">b</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
        <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">b</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-2">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-2">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-2">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
1
6
1
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="æœ€å°å…¬å€æ•°">æœ€å°å…¬å€æ•°</h2>

<ul>
  <li>ï¼’ã¤ã®å¼•æ•°ã®LCMã‚’æ±‚ã‚ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(O(log(max(a,b)))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">lcm</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">s</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
    <span class="n">a</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="n">b</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
        <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">b</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-3">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-3">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">lcm</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-3">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>12
15
36
104
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="ç´„æ•°åˆ—æŒ™">ç´„æ•°åˆ—æŒ™</h2>

<ul>
  <li>è‡ªç„¶æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€\(N\)ã®æ­£ã®ç´„æ•°ã‚’å°ã•ã„é †ã«ä¸¦ã¹ãŸvectorã‚’è¿”ã™</li>
  <li>æ­£ã§ãªã„æ•°ã‚’ä¸ãˆã‚‹ã¨ç©ºã®vectorã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(O(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">!=</span><span class="n">N</span><span class="p">)</span><span class="n">s</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-4">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-4">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">divisor_enum</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">K</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-4">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1  1 
2  1 2 
3  1 3 
4  1 2 4 
5  1 5 
6  1 2 3 6 
7  1 7 
8  1 2 4 8 
9  1 3 9 
10  1 2 5 10 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="ç´ æ•°åˆ¤å®š">ç´ æ•°åˆ¤å®š</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(x\)ã«å¯¾ã—ã€\(x\)ãŒç´ æ•°ãªã‚‰trueã‚’ã€ãã†ã§ãªã„ãªã‚‰falseã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(O(\sqrt{x})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="nf">prime</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">X</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-5">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-5">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">bool</span> <span class="nf">prime</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">prime</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-5">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 2 3 4 5 6 7 8 9 10 
0 0 1 1 0 1 0 1 0 0 0 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="ç´ æ•°åˆ—æŒ™">ç´ æ•°åˆ—æŒ™</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(N\)ã«å¯¾ã—ã€\(N\)ä»¥ä¸‹ã®ç´ æ•°ã‚’åˆ—æŒ™ã—ã€å°ã•ã„é †ã«vectorã¨ã—ã¦è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(O(NloglogN)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">prime</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">prime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="n">prime</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
            <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-6">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-6">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">primearray</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-6">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="ç´ å› æ•°åˆ†è§£">ç´ å› æ•°åˆ†è§£</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(N\)ã«å¯¾ã—ã€\(N\)ã‚’ç´ å› æ•°åˆ†è§£ã—ã€å°ã•ã„é †ã«vectorã¨ã—ã¦è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">N</span><span class="o">/=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
          <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-7">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-7">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">210</span><span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">prime_factorization</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-7">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4  2 2 
12  2 2 3 
57  3 19 
97  97 
210  2 3 5 7 
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="ç´¯ä¹—ç¹°ã‚Šè¿”ã—äºŒä¹—æ³•">ç´¯ä¹—(ç¹°ã‚Šè¿”ã—äºŒä¹—æ³•)</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(b,e\)ã«å¯¾ã—ã€\(b^e\)ã‚’è¿”ã™</li>
  <li>\(MOD\)ã‚‚ä¸ãˆã‚‹ã¨ãã‚Œã§å‰²ã£ãŸä½™ã‚Šã‚’ã¨ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(log(e))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-8">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-8">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"2ã®iä¹—"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"2ã®iä¹—ã‚’100ã§å‰²ã£ãŸã‚ã¾ã‚Š"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-8">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2ã®iä¹—
1 2 4 8 16 32 64 128 256 512 1024 
2ã®iä¹—ã‚’100ã§å‰²ã£ãŸã‚ã¾ã‚Š
1 2 4 8 16 32 64 28 56 12 24
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="é€†å…ƒç´ æ•°mod">é€†å…ƒ(ç´ æ•°MOD)</h2>

<ul>
  <li>ä¸ãˆã‚‰ã‚ŒãŸ\(b,MOD\)ã«å¯¾ã—ã€\(MOD\)ã‚’æ³•ã¨ã—ãŸæ•´æ•°ç’°ä¸Šã§ã®é€†å…ƒ(\(bx=1\)ã‚’æº€ãŸã™\(x\))ã‚’è¿”ã™</li>
  <li>MODãŒç´ æ•°ã§ãªã„å ´åˆã®å‹•ä½œã¯æœªç¢ºèª</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(log(MOD))\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">inverse</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-9">ä½¿ç”¨ä¾‹</h3>

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-9">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">inverse</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"mod 7ã§ã®iã®é€†å…ƒ"</span><span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">7</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">inverse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">%</span><span class="mi">7</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-9">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mod 7ã§ã®iã®é€†å…ƒ
1 1 1
2 4 1
3 5 1
4 2 1
5 3 1
6 6 1
</code></pre></div></div>

<p><a href="#ã‚‚ãã˜">ã‚‚ãã˜ã«æˆ»ã‚‹</a></p>

<hr />

<h2 id="æ›´æ–°å±¥æ­´">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/05</td>
      <td style="text-align: left">ç´„æ•°åˆ—æŒ™ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/27</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">è»½å¾®ãªãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/06/01</td>
      <td style="text-align: left">ç´ å› æ•°åˆ†è§£ã®ãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/03</td>
      <td style="text-align: left">æ•°å­¦è©°ã‚åˆã‚ã›ãƒ‘ãƒƒã‚¯ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ç´ æ•°modäºŒé …ä¿‚æ•°-">ğŸ”´ ç´ æ•°modäºŒé …ä¿‚æ•° ğŸ”´</h1>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€combã‚’å®Ÿè¡Œã™ã‚‹ã®ã«å¿…è¦ãªæ•°å€¤(éšä¹—ã¨ãã®é€†å…ƒ)ã‚’å‰è¨ˆç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>binomial_coefficient</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>extension</p>
<ul>
  <li>initã§ç”¨æ„ã—ãŸç¯„å›²ã§è¶³ã‚Šãªã„å ´åˆã€æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ä¸è¶³åˆ†ã‚’è¿½åŠ ã§å‰è¨ˆç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯å®Ÿè¡Œå‰ã®ã‚µã‚¤ã‚ºã‚’\(s\)ã¨ã—ã¦ã€\(ÎŸ(N-s+log(MOD))\)</li>
</ul>

<p>comb</p>
<ul>
  <li>æ•´æ•°\(n,r\)ã‚’ä¸ãˆã‚‹ã¨ã€\(\frac{n!}{r!(n-r)!}\)ã‚’\(MOD\)ã§å‰²ã£ãŸä½™ã‚Šã‚’è¿”ã™</li>
  <li>ã‚‚ã—ã“ã‚Œã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®å‰è¨ˆç®—ãŒä¸è¶³ã—ã¦ã„ã‚‹å ´åˆã€ã¡ã‚‡ã†ã©è£œå®Œã™ã‚‹ã‚ˆã†ã«extensionãŒå®Ÿè¡Œã•ã‚Œã‚‹</li>
  <li>ã“ã®ãŸã‚ã€è¨ˆç®—é‡ã‚’æ°—ã«ã—ãªã‘ã‚Œã°initã¯å‘¼ã°ãªãã¦ã‚‚è‰¯ã„</li>
  <li>ã¾ãŸæœ€åˆã«initã«ååˆ†ãªå€¤ã‚’ä¸ãˆã¦ã„ã‚Œã°extensionã¯å‘¼ã°ã‚Œãªã„</li>
  <li>è¨ˆç®—é‡ã¯extensionã®ã‚‚ã®+\(ÎŸ(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/binomial%20coefficient.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">binomial_coefficient</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">998244353</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">sze</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">fact</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factinv</span><span class="p">;</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Gfinv</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="o">=</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        
        <span class="n">fact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">factinv</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gfinv</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">N</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">binomial_coefficient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">extension</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sze</span><span class="o">&gt;</span><span class="n">N</span> <span class="o">&amp;&amp;</span> <span class="n">sze</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">;</span>
        <span class="p">}</span>
        
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        
        <span class="n">fact</span><span class="p">[</span><span class="n">sze</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">sze</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">sze</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sze</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">sze</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">factinv</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gfinv</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">N</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">sze</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;=</span><span class="n">sze</span><span class="p">){</span>
            <span class="n">extension</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">r</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-10">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-10">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">binomial_coefficient</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">binomial_coefficient</span> <span class="n">BC</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-10">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 0 0 0 0 0 
1 1 0 0 0 0 
1 2 1 0 0 0 
1 3 3 1 0 0 
1 4 6 4 1 0 
1 5 10 10 5 1 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-1">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">åç§°ã‚’äºŒé …ä¿‚æ•°ã‹ã‚‰ç´ æ•°modäºŒé …ä¿‚æ•°ã«å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/02/18</td>
      <td style="text-align: left">nã‚’æŒ‡å®šã—ã¦vectorã‚’è¿”ã™å½¢å¼ã‹ã‚‰classåŒ–ã—n,rã‹ã‚‰nCrã‚’è¿”ã™å½¢å¼ã«å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">äºŒé …ä¿‚æ•°ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ç´ å› æ•°åˆ†è§£ç·šå½¢ç¯©-">ğŸ”´ ç´ å› æ•°åˆ†è§£(ç·šå½¢ç¯©) ğŸ”´</h1>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€å‰è¨ˆç®—ã¨ã—ã¦\(N\)ä»¥ä¸‹ã®åˆæˆæ•°\(i\)ã«ã¤ã„ã¦\(i\)ã®è‡ªæ˜ã§ãªã„(\(1\)ã§ã‚‚\(i\)ã§ã‚‚ãªã„)ç´„æ•°ã®1ã¤ã‚’æ±‚ã‚ã‚‹</li>
  <li>ãã‚Œã¨åŒæ™‚ã«ã€\(N\)ä»¥ä¸‹ã®ç´ æ•°ã®ãƒªã‚¹ãƒˆã‚‚æ±‚ã‚ã‚‹</li>
  <li>ä»¥é™ã®é–¢æ•°ã«\(N\)ã‚ˆã‚Šå¤§ãã„å€¤ã‚’ä¸ãˆã‚‹ã¨è£œå®Œã®ãŸã‚ã«initãŒå‘¼ã°ã‚Œã‚‹ã€‚ã“ã‚Œã¯æœ€åˆã«initã«ååˆ†å¤§ãã„å€¤ã‚’ä¸ãˆã‚‹ã“ã¨ã§å›é¿ã§ãã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>linear_sieve</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>primearray</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€\(N\)ä»¥ä¸‹ã®ç´ æ•°ã‚’æ˜‡é †ã«ä¸¦ã¹ãŸvectorã‚’è¿”ã™</li>
  <li>ã‚‚ã—å‰è¨ˆç®—ãŒè¶³ã‚Šãªã„å ´åˆã€ã¡ã‚‡ã†ã©è£œå®Œã™ã‚‹ã‚ˆã†ã«initãŒå®Ÿè¡Œã•ã‚Œã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®ã‚‚ã®+\(ÎŸ(N/log(N))\)</li>
</ul>

<p>divisor</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€å‰è¨ˆç®—ã—ãŸ\(N\)ã®è‡ªæ˜ã§ãªã„ç´„æ•°ã®1ã¤ã‚’è¿”ã™</li>
  <li>ã‚‚ã—\(N\)ãŒç´ æ•°ãªã‚‰\(N\)ã‚’ã€\(1\)ãªã‚‰\(1\)ã‚’ã€æ­£ã§ãªã„ãªã‚‰\(-1\)ã‚’è¿”ã™</li>
  <li>ã‚‚ã—å‰è¨ˆç®—ãŒè¶³ã‚Šãªã„å ´åˆã€ã¡ã‚‡ã†ã©è£œå®Œã™ã‚‹ã‚ˆã†ã«initãŒå®Ÿè¡Œã•ã‚Œã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®ã‚‚ã®+\(ÎŸ(1)\)</li>
</ul>

<p>factorization</p>
<ul>
  <li>æ•´æ•°\(X\)ã‚’ä¸ãˆã‚‹ã¨ã€\(X\)ã‚’ç´ å› æ•°åˆ†è§£ã—ã€çµæœã‚’<strong>å¤§ãã„é †ã«</strong>ä¸¦ã¹ã€vectorã¨ã—ã¦è¿”ã™</li>
  <li>ã‚‚ã—å‰è¨ˆç®—ãŒè¶³ã‚Šãªã„å ´åˆã€ã¡ã‚‡ã†ã©è£œå®Œã™ã‚‹ã‚ˆã†ã«initãŒå®Ÿè¡Œã•ã‚Œã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®ã‚‚ã®+\(ÎŸ(log(N))\)</li>
</ul>

<p>exp_enum</p>
<ul>
  <li>æ•´æ•°\(N,M,mod\)ã‚’ä¸ãˆã‚‹ã¨ã€\(0^M,1^M,...,N^M\)ã‚’ãã‚Œãã‚Œ\(mod\)ã§å‰²ã£ãŸã‚ã¾ã‚Šã‚’è¨ˆç®—ã—ã€vectorã¨ã—ã¦è¿”ã™</li>
  <li>\(N,M\)ãŒè² ã§ã‚ã‚‹å ´åˆã€ç©ºã®vectorã‚’è¿”ã™</li>
  <li>ã‚‚ã—å‰è¨ˆç®—ãŒè¶³ã‚Šãªã„å ´åˆã€ã¡ã‚‡ã†ã©è£œå®Œã™ã‚‹ã‚ˆã†ã«initãŒå®Ÿè¡Œã•ã‚Œã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®ã‚‚ã®+\(ÎŸ(N + N \frac{log(M)}{log(N)})\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/linear%20sieve.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">linear_sieve</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">S</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">divisor_</span><span class="p">,</span><span class="n">prime</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">S</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">divisor_</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">divisor_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
                <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">N</span> <span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">divisor_</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">linear_sieve</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">primearray</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">X</span><span class="p">){</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">divisor</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factorization</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">X</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">X</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">factorization</span><span class="p">(</span><span class="n">X</span><span class="o">/</span><span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">]);</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">divisor_</span><span class="p">[</span><span class="n">X</span><span class="p">]);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">exp_enum</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span><span class="o">=</span><span class="n">LLONG_MAX</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">)</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">N</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">e</span><span class="o">=</span><span class="n">M</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">R</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="n">divisor_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-11">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-11">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">linear_sieve</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">linear_sieve</span> <span class="n">sieve</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"100ä»¥ä¸‹ã®ç´ æ•°ã®ãƒªã‚¹ãƒˆ"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">primearray</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"1~10ã®ç´„æ•°ã®ä¸€ã¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">sieve</span><span class="p">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"4,12,57,97,210ã®ç´ å› æ•°åˆ†è§£"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">210</span><span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">factorization</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0~10ã«ã¤ã„ã¦ã€i^3"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">sieve</span><span class="p">.</span><span class="n">exp_enum</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-11">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100ä»¥ä¸‹ã®ç´ æ•°ã®ãƒªã‚¹ãƒˆ
2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 

1~10ã®ç´„æ•°ã®ä¸€ã¤
1 2 3 2 5 2 7 2 3 2 

4,12,57,97,210ã®ç´ å› æ•°åˆ†è§£
2 2 
3 2 2 
19 3 
97 
7 5 3 2 

0~10ã«ã¤ã„ã¦ã€i^3
0 1 8 27 64 125 216 343 512 729 1000 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-2">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/24</td>
      <td style="text-align: left">ç´ å› æ•°åˆ†è§£(ç·šå½¢ç¯©)ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•-">ğŸ”´ æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³• ğŸ”´</h1>

<p>æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã€extended Euclidean algorithmã®å¯¾è¨³æ„ŸãŒãã‚“ãªã«ãªã„ã­ã€€ã©ã†ã§ã‚‚ã„ã„ã­</p>

<p>æ•´æ•°\(a,b\)ã‚’ä¸ãˆã‚‹ã¨ã€\(g=gcd(a,b)\)ã¨ãã‚Œã‚’ç”¨ã„ã¦è¡¨ã•ã‚Œã‚‹ç­‰å¼</p>

\[ax+by=g\]

<p>ã‚’æº€ãŸã™\((x,y)\)(ãƒ™ã‚ºãƒ¼ä¿‚æ•°)ã‚’ä¸€ã¤æ±‚ã‚ã€\(g\)ã¨ã¨ã‚‚ã«è¿”ã™</p>

<p>è¨ˆç®—é‡ã¯\(O(log(max(a,b)))\)</p>

<p>ã“ã“ã§è¿”ã‚Šå€¤ã¯pair&lt;ll,pair&lt;ll,llÂ»ã¨ãªã£ã¦ã„ã‚‹ãŒã€ãã‚Œãã‚Œ\(\{g,\{x,y\}\}\)ã‚’è¡¨ã—ã¦ã„ã‚‹</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/extended%20Euclidean%20algorithm.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">extgcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">b</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">;</span>
        <span class="n">r</span><span class="o">+=</span><span class="n">b</span><span class="p">;</span>
        <span class="n">r</span><span class="o">%=</span><span class="n">b</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">q_</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q_</span><span class="p">);</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">g</span><span class="o">*=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">x</span><span class="o">*=-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="n">g</span><span class="p">,{</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">}};</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-12">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-12">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">extgcd</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">extgcd</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">second</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111ã¨30ã®æœ€å¤§å…¬ç´„æ•°"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111x+30y=3ã‚’æº€ãŸã™ã‚ˆã†ãª(x,y)ã®ä¸€ä¾‹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"111x+30y"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">111</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">30</span><span class="o">*</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-12">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>111ã¨30ã®æœ€å¤§å…¬ç´„æ•°
3

111x+30y=3ã‚’æº€ãŸã™ã‚ˆã†ãª(x,y)ã®ä¸€ä¾‹
(3,-11)

111x+30y
3
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-3">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/08</td>
      <td style="text-align: left">æ¬ è½ã—ã¦ã„ãŸè¨ˆç®—é‡ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/08</td>
      <td style="text-align: left">æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-å‡¸åŒ…-">ğŸ”´ å‡¸åŒ… ğŸ”´</h1>

<p>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯Andrewã®monotone chainã¨ã„ã†åå‰ã‚‰ã—ã„</p>

<p>äºŒæ¬¡å…ƒä¸Šã®ç‚¹é›†åˆã‚’vector&lt;pair&lt;long long,long longÂ»ã§ä¸ãˆã‚‹</p>

<p>ã™ã‚‹ã¨ãã®ç‚¹é›†åˆã®å‡¸åŒ…ã‚’æ±‚ã‚ã€xåº§æ¨™ãŒæœ€ã‚‚å°ã•ã„ç‚¹ã®ã†ã¡yåº§æ¨™ãŒæœ€ã‚‚å°ã•ã„ç‚¹ã‹ã‚‰å§‹ã‚ã¦åæ™‚è¨ˆå›ã‚Šã«ä¸¦ã¹ã¦vector&lt;pair&lt;long long,long longÂ»ã§è¿”ã™</p>

<p>è¨ˆç®—é‡ã¯\(O(\vert P \vert log \vert P \vert)\)(ã‚½ãƒ¼ãƒˆãŒãƒãƒƒã‚¯ã«ãªã£ã¦ãŠã‚Šã€ã‚½ãƒ¼ãƒˆãŒãªã‘ã‚Œã°\(O(\vert P \vert)\))</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/convex%20hull.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">H</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">;</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">P</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    
    <span class="c1">//ä¸‹åŠåˆ†</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">L</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)){</span>
            <span class="n">L</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">L</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="c1">//ä¸ŠåŠåˆ†</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">second</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">-</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">first</span><span class="p">)){</span>
            <span class="n">H</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">H</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    
    <span class="n">R</span><span class="o">=</span><span class="n">L</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">H</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-13">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-13">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">;</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    
    <span class="n">Q</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Q</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-13">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 0
2 0
2 2
0 2
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-4">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/22</td>
      <td style="text-align: left">å‡¸åŒ…ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°-">ğŸ”´ ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•° ğŸ”´</h1>

<p>\(\varphi\)ã¯ãƒˆãƒ¼ã‚·ã‚§ãƒ³ãƒˆã¨èª­ã‚€ã‚‰ã—ã„</p>

<p>\(\varphi(n)\)ã¨ã¯ã€\(1\)ã‹ã‚‰\(n\)ã¾ã§ã®æ•´æ•°ã§ã€\(n\)ã¨äº’ã„ã«ç´ ã§ã‚ã‚‹ã‚‚ã®ã®å€‹æ•°</p>

<p>ã“ã‚Œã¯ã€\(n\)ãŒç›¸é•ãªç´ å› æ•°\(p_1,p_2,...,p_d\)ã‚’å«ã‚€ã¨ã—ã¦</p>

\[\varphi(n) = n\prod_{k=1}^d (1-\frac{1}{p_k})\]

<p>ã¨è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/Euler's%20totient%20function.cpp">github</a></p>

<p>å˜ä½“</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€\(\varphi(N)\)ã‚’è¨ˆç®—ã—æ•´æ•°ã§è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(O(\sqrt{N})\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">totient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">R</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span> <span class="o">-=</span> <span class="n">R</span><span class="o">/</span><span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">N</span><span class="o">/=</span><span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">R</span> <span class="o">-=</span> <span class="n">R</span><span class="o">/</span><span class="n">N</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>åˆ—æŒ™</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€\(0\)ã‹ã‚‰\(N\)ã¾ã§ã®\(\varphi(i)\)ã‚’è¨ˆç®—ã—,è¦ç´ æ•°ãŒ\(N+1\)ã®vectorã§è¿”ã™</li>
  <li>ã“ã“ã§ã€\(\varphi(0)=0\)ã¨ã—ã¦ã„ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(O(NloglogN)\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">totient_array</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
            <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-=</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-14">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-14">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">int</span> <span class="nf">totient</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">totient_array</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">totient</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">totient_array</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-14">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 1 2 2 4 2 6 4 6 4 
0 1 1 2 2 4 2 6 4 6 4 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-5">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/16</td>
      <td style="text-align: left">ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›-">ğŸ”´ é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ› ğŸ”´</h1>

<p>ã‚¯ãƒ©ã‚¹ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŒã€å®Ÿè¡Œã™ã‚‹ã¨ãã¯convolutionã‚’å‘¼ã³å‡ºã›ã°ã„ã„</p>

<p>å¤šé …å¼ã«è¦‹ç«‹ã¦ãŸvectorã‚’\(2\)ã¤ä¸ãˆã‚‹ã¨ã€ãã‚Œã‚‰ã«å¯¾ã—é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã‚’ç”¨ã„ãŸç•³ã¿è¾¼ã¿æ¼”ç®—ã‚’è¡Œã„ä¸€ã¤ã®å¤šé …å¼ã«ã—ã€vectorã¨ã—ã¦è¿”ã™</p>

<p>\(\{1,2,3\}*\{1,3,5\}=\{1,5,14,19,15\}\)ã¨ã„ã£ãŸèª¿å­</p>

<p>å®Ÿè£…ä¸Šdoubleã‚’çµŒç”±ã—ã¦ã„ã‚‹ã®ã§èª¤å·®æ­»ãŒæ€–ã„</p>

<p>è¨ˆç®—é‡ã¯\(N=max(\vert A \vert,\vert B\vert)\)ã¨ã—ã¦ã€\(ÎŸ(NlogN)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/fast%20Fourier%20transform.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">fast_Fourier_transform</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">PI</span><span class="o">=</span><span class="mf">3.14159265358979</span><span class="p">;</span> 
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">DFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A0</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">A1</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">iA0</span><span class="p">,</span><span class="n">iA1</span><span class="p">,</span><span class="n">iA</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">A0</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">A1</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">iA0</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>
        <span class="n">iA1</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">ith_zeta</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">N</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">N</span><span class="p">));</span>
            <span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA0</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span> <span class="n">ith_zeta</span><span class="o">*</span><span class="n">iA1</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">iA</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">iDFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">iA</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">iA</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">dA</span><span class="p">,</span><span class="n">rA</span><span class="p">;</span>
        <span class="n">dA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">iA</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">rA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">dA</span><span class="p">[(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">N</span><span class="p">]);</span>
            <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">rA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">convolution</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">deg</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="n">deg</span><span class="p">){</span><span class="n">N</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;}</span>
        <span class="n">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span><span class="n">B</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">dC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">dA</span><span class="p">,</span><span class="n">iA</span><span class="p">,</span><span class="n">dB</span><span class="p">,</span><span class="n">iB</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">dA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">dB</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">iA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">dA</span><span class="p">);</span><span class="n">iB</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">dB</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">iB</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">dC</span><span class="o">=</span><span class="n">iDFT</span><span class="p">(</span><span class="n">iC</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">dC</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="o">+</span><span class="n">dC</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">C</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deg</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-15">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-15">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">fast_Fourier_transform</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">fast_Fourier_transform</span> <span class="n">FFT</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="n">C</span><span class="p">;</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">FFT</span><span class="p">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-15">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 5 14 19 15 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-6">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-æ•°è«–å¤‰æ›-">ğŸ”´ æ•°è«–å¤‰æ› ğŸ”´</h1>

<p>æ•´æ•°ç’°FFTã¨ã‚‚</p>

<p>åŸºæœ¬çš„ã«ã¯<a href="./fft">FFT</a>ã¨åŒã˜ã ãŒã€ã‚ã¡ã‚‰ãŒå®Ÿæ•°ã‚’ä½¿ã£ã¦è¨ˆç®—ã™ã‚‹ã®ã«å¯¾ã—ã“ã¡ã‚‰ã¯æœ‰ç†æ•°ã‚’ç´ æ•°ã§å‰²ã£ãŸä½™ã‚Šã‚’ä½¿ã£ã¦è¨ˆç®—ã™ã‚‹</p>

<p>èª¤å·®ãŒãªã„ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ãŒã€\(MOD\)ç´ æ•°ã‚ˆã‚Šå¤§ãã„æ•´æ•°ã‚’æ‰±ãˆãªã„ã¨ã„ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹</p>

<p>ã“ã“ã§ç”¨ã„ã‚‹ç´ æ•°ã¯ã€\(P-1\)ãŒç´ å› æ•°ã«\(2\)ã‚’å¤šãå«ã‚€ã‚ˆã†ãª\(P\)ã§ã‚ã‚‹ã“ã¨ãŒæœ›ã¾ã—ã„(ä¾‹ãˆã°NTTã§ã‚ˆãä½¿ã‚ã‚Œã‚‹\(998244353\)ã¯\(119 \cdot 2^{23}+1\)ã§ã‚ã‚‹)</p>

<p>è¨ˆç®—é‡ã¯\(N=max(\vert A \vert,\vert B \vert)\)ã¨ã—ã¦ã€\(ÎŸ(NlogNlogMOD)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/number%20theoretic%20transform.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">number_theoretic_transform</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">998244353</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">119</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">pri_root</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="c1">//MOD=k*2^n+1</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">BE</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">DFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A0</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">A1</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">iA0</span><span class="p">,</span><span class="n">iA1</span><span class="p">,</span><span class="n">iA</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">A0</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">A1</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">iA0</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>
        <span class="n">iA1</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">omega</span><span class="o">=</span><span class="n">BE</span><span class="p">(</span><span class="n">pri_root</span><span class="p">,</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">);</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">ith_zeta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA0</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span> <span class="n">ith_zeta</span><span class="o">*</span><span class="n">iA1</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="n">ith_zeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ith_zeta</span><span class="o">*</span><span class="n">omega</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">iA</span><span class="p">;</span>
    <span class="p">}</span>
     
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">iDFT</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">iA</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">iA</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N_inverse</span> <span class="o">=</span> <span class="n">BE</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">dA</span><span class="p">,</span><span class="n">rA</span><span class="p">;</span>
        <span class="n">dA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">iA</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">rA</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">dA</span><span class="p">[(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">N</span><span class="p">]);</span>
            <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">((</span><span class="n">rA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">N_inverse</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    <span class="p">}</span>
    
    
    <span class="nl">public:</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">convolution</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">deg</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="n">deg</span><span class="p">){</span><span class="n">N</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;}</span>
        <span class="n">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span><span class="n">B</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iC</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">iA</span><span class="p">,</span><span class="n">iB</span><span class="p">;</span>
        <span class="n">iA</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">A</span><span class="p">);</span><span class="n">iB</span><span class="o">=</span><span class="n">DFT</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">iC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">iA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">iB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">C</span><span class="o">=</span><span class="n">iDFT</span><span class="p">(</span><span class="n">iC</span><span class="p">);</span>
        <span class="n">C</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">deg</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-16">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-16">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">number_theoretic_transform</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">number_theoretic_transform</span> <span class="n">NTT</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="n">C</span><span class="p">;</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">NTT</span><span class="p">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-16">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 5 14 19 15 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-7">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ /vectorã‚’std::vectorã«å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">æ•°è«–å¤‰æ›ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ä»»æ„modäºŒé …ä¿‚æ•°-">ğŸ”´ ä»»æ„modäºŒé …ä¿‚æ•° ğŸ”´</h1>

<p>è¨ˆç®—é‡ã®ç•°ãªã‚‹ \(2\) ã¤ã®ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/math/composite%20binomial%20coefficient.cpp">github</a></p>

<ul>
  <li><a href="#ãã®ï¼‘">ãã®ï¼‘</a>
    <ul>
      <li>\(n,r \leq 10^{18}, mod \leq 10^6\) ç¨‹åº¦ã®å ´åˆã«è¨ˆç®—ã§ãã‚‹</li>
    </ul>
  </li>
  <li><a href="#ãã®ï¼’">ãã®ï¼’</a>
    <ul>
      <li>\(n,r \leq 10^6, mod \leq 10^9\) ç¨‹åº¦ã®å ´åˆã«è¨ˆç®—ã§ãã‚‹</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="ãã®ï¼‘">ãã®ï¼‘</h2>

<p>init</p>
<ul>
  <li>mod \(M\)ã‚’ä¸ãˆã‚‹ã¨ã€combã‚’å®Ÿè¡Œã™ã‚‹ã®ã«å¿…è¦ãªæ•°å€¤ã‚’å‰è¨ˆç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯ \(M\) ã®ç´ å› æ•°åˆ†è§£ã‚’ \(\prod_{i=1}^{\omega(M)}{ {p_i}^{e_i}}\) ã¨ã™ã‚‹ã¨ \(ÎŸ( \sum_{i=1}^{\omega(M)}{ {p_i}^{e_i}} + \sqrt{M})\)
    <ul>
      <li>\(\omega(m)\) ã¯ \(m\) ã®ç´ å› æ•°ã®å€‹æ•°ã€\(m \leq 10^9\) ã®ã¨ã \(\omega(m) \leq 10\)</li>
    </ul>
  </li>
</ul>

<p>composite_binomial_coefficient_1</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>comb</p>
<ul>
  <li>æ•´æ•°\(n,r\)ã‚’ä¸ãˆã‚‹ã¨ã€\(\frac{n!}{r!(n-r)!}\)ã‚’\(M\)ã§å‰²ã£ãŸä½™ã‚Šã‚’è¿”ã™</li>
  <li>extensionã¯ãªã„ãŸã‚ã€\(n\) ã«initã§ä¸ãˆãŸ \(N\) ã‚ˆã‚Šå¤§ãã„å€¤ã‚’ä¸ãˆãŸå ´åˆã®æŒ™å‹•ã¯ä¿è¨¼ã—ãªã„</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ( (\log n + \log M) \omega(M) )\)</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">composite_binomial_coefficient_1</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Mod</span><span class="p">;</span>    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">fact</span><span class="p">,</span><span class="n">factinv</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">bezout</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">D</span><span class="p">.</span><span class="n">first</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="nl">public:</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>

        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>

        <span class="c1">//Mã‚’ç´ å› æ•°åˆ†è§£ã™ã‚‹</span>
        <span class="c1">//Pã¯{ç´ æ•°,å€‹æ•°,ç´ æ•°^å€‹æ•°}</span>
        <span class="n">P</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">m</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">e</span><span class="o">++</span><span class="p">;</span>
                <span class="n">m</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
                <span class="n">v</span> <span class="o">*=</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">i</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">});</span>
        <span class="p">}</span>

        <span class="c1">//ç”¨ã„ã‚‹ç´ æ•°pã«ã¤ã„ã¦ã€(x!)_p := (1~xã§pã¨äº’ã„ã«ç´ ãªã‚‚ã®ã®ç©)ã‚’æ±‚ã‚ã‚‹</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">fact</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">factinv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
            <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
            <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]).</span><span class="n">first</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
            
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
                <span class="k">if</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">composite_binomial_coefficient_1</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">mod</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span> <span class="o">||</span> <span class="n">Mod</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">;</span>

        <span class="c1">//å„p^qã«ã¤ã„ã¦nCr mod p^qã‚’æ±‚ã‚ã¦Lã«ã¾ã¨ã‚ã‚‹</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">pq</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>

            <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">R</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">N</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nown</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">K</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nowk</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">nowr</span><span class="o">%</span><span class="n">pq</span><span class="p">);</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">long</span> <span class="kt">long</span> <span class="n">e0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">p</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">p</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">p</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">e0</span> <span class="o">+=</span> <span class="n">nown</span><span class="p">;</span>
                <span class="n">e0</span> <span class="o">-=</span> <span class="n">nowk</span><span class="p">;</span>
                <span class="n">e0</span> <span class="o">-=</span> <span class="n">nowr</span><span class="p">;</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">nown</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="n">pq</span><span class="p">,</span> <span class="n">nowk</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">pq</span><span class="p">,</span> <span class="n">nowr</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">pq</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">nown</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">e1</span> <span class="o">+=</span> <span class="n">nown</span><span class="p">;</span>
                <span class="n">e1</span> <span class="o">-=</span> <span class="n">nowk</span><span class="p">;</span>
                <span class="n">e1</span> <span class="o">-=</span> <span class="n">nowr</span><span class="p">;</span>
                <span class="n">nown</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowk</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
                <span class="n">nowr</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
            
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">((</span><span class="n">p</span><span class="o">!=</span><span class="mi">2</span> <span class="o">||</span> <span class="n">q</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">e1</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">pq</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">N</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">N</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">K</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">factinv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">e0</span><span class="p">);</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">pq</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">T</span><span class="p">,</span><span class="n">pq</span><span class="p">};</span>
        <span class="p">}</span>

        <span class="c1">//ä¸­å›½å‰°ä½™å®šç†ã‚’ç”¨ã„ã¦å¾©å…ƒã™ã‚‹</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">q</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(((</span><span class="n">C</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">*</span><span class="n">C</span><span class="p">.</span><span class="n">second</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="n">C</span><span class="p">.</span><span class="n">first</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
            <span class="n">C</span><span class="p">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">q</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">C</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-17">ä½¿ç”¨ä¾‹</h3>
<hr />

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-17">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">composite_binomial_coefficient_1</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"10ã§å‰²ã£ãŸã‚ã¾ã‚Š"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
    <span class="n">composite_binomial_coefficient_1</span> <span class="n">CBC</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ã‚‚ã¨ã®å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">composite_binomial_coefficient_1</span> <span class="n">CBC_origin</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC_origin</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-17">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10ã§å‰²ã£ãŸã‚ã¾ã‚Š
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 0 0 5 1 
1 6 5 0 5 6 1 
1 7 1 5 5 1 7 1 
1 8 8 6 0 6 8 8 1 

ã‚‚ã¨ã®å€¤
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 10 10 5 1 
1 6 15 20 15 6 1 
1 7 21 35 35 21 7 1 
1 8 28 56 70 56 28 8 1 

</code></pre></div></div>

<h3 id="æ›´æ–°å±¥æ­´-8">æ›´æ–°å±¥æ­´</h3>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">ä»»æ„modäºŒé …ä¿‚æ•°ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://judge.yosupo.jp/problem/binomial_coefficient">Library Checker</a></td>
      <td style="text-align: left"><a href="https://judge.yosupo.jp/submission/130133">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="ãã®ï¼’">ãã®ï¼’</h2>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã¨mod \(M\)ã‚’ä¸ãˆã‚‹ã¨ã€combã‚’å®Ÿè¡Œã™ã‚‹ã®ã«å¿…è¦ãªæ•°å€¤ã‚’å‰è¨ˆç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯ \(ÎŸ(N \log N + N \omega(M) + \sqrt{M})\)
    <ul>
      <li>\(\omega(m)\) ã¯ \(m\) ã®ç´ å› æ•°ã®å€‹æ•°ã€\(m \leq 10^9\) ã®ã¨ã \(\omega(m) \leq 10\)
<!-- âˆšM + NÏ‰(M) + Î©(N!) , ã‚‚ã£ã¨ã‚¿ã‚¤ãƒˆãªè©•ä¾¡ãŒã§ããã† --></li>
    </ul>
  </li>
</ul>

<p>composite_binomial_coefficient_2</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>comb</p>
<ul>
  <li>æ•´æ•°\(n,r\)ã‚’ä¸ãˆã‚‹ã¨ã€\(\frac{n!}{r!(n-r)!}\)ã‚’\(M\)ã§å‰²ã£ãŸä½™ã‚Šã‚’è¿”ã™</li>
  <li>extensionã¯ãªã„ãŸã‚ã€\(n\) ã«initã§ä¸ãˆãŸ \(N\) ã‚ˆã‚Šå¤§ãã„å€¤ã‚’ä¸ãˆãŸå ´åˆã®æŒ™å‹•ã¯ä¿è¨¼ã—ãªã„</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\log M + \omega(M) )\)
    <ul>
      <li>ç‰¹ã«ã€ \(n,r\) ã«ä¾å­˜ã—ãªã„</li>
    </ul>
  </li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">composite_binomial_coefficient_2</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">sze</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Mod</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span><span class="n">prime</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">index</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">factPri</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">factRel</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">power</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">bezout</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">D</span><span class="p">.</span><span class="n">first</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">D</span><span class="p">.</span><span class="n">second</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="nl">public:</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>

        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">M</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">sze</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">Mod</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span>
        
        <span class="c1">//1~Nã®éè‡ªæ˜ãªç´„æ•°ã‚’æ±‚ã‚ã‚‹</span>
        <span class="n">d</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">d</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">prime</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">index</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">index</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">index</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
                <span class="n">prime</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">prime</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">N</span> <span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">d</span><span class="p">[</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prime</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//æ³•ãŒå«ã‚€ç´ æ•°ã®ãƒªã‚¹ãƒˆã‚’æ±‚ã‚ã‚‹</span>
        <span class="n">P</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">M</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">e</span><span class="o">++</span><span class="p">;</span>
                <span class="n">M</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">)</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
                <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">M</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">)</span><span class="n">index</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
            <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">//k!ã«ã¤ã„ã¦ã€Mã¨äº’ã„ã«ç´ ã§ã‚ã‚‹éƒ¨åˆ†ã¨ãã†ã§ãªã„éƒ¨åˆ†ã«åˆ†ã‘ã¦ãã‚Œãã‚Œæ±‚ã‚ã‚‹</span>
        <span class="n">factPri</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">factPri</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">factPri</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">factRel</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
            <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>

            <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>

            <span class="kt">long</span> <span class="kt">long</span> <span class="n">now</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">now</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
                <span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">now</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">factRel</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="n">p</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">now</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//p^0,p^1,...,p^(N/p)ã‚’å‰è¨ˆç®—ã™ã‚‹</span>
        <span class="n">power</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">+</span><span class="n">N</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="n">composite_binomial_coefficient_2</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">M</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">comb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Mod</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">r</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">factPri</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="n">Mod</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">m</span><span class="o">+=</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">bezout</span><span class="p">(</span><span class="n">factPri</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">],</span><span class="n">Mod</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">m</span><span class="o">+=</span><span class="n">Mod</span><span class="p">;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="n">factRel</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">factRel</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">factRel</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="n">assert</span><span class="p">(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">e</span><span class="p">])</span><span class="o">%</span><span class="n">Mod</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">};</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨ä¾‹-18">ä½¿ç”¨ä¾‹</h3>
<hr />

<h4 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-18">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">composite_binomial_coefficient_2</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"10ã§å‰²ã£ãŸã‚ã¾ã‚Š"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
    <span class="n">composite_binomial_coefficient_2</span> <span class="n">CBC</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ã‚‚ã¨ã®å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">composite_binomial_coefficient_2</span> <span class="n">CBC_origin</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">CBC_origin</span><span class="p">.</span><span class="n">comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="å‡ºåŠ›-18">å‡ºåŠ›</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10ã§å‰²ã£ãŸã‚ã¾ã‚Š
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 0 0 5 1 
1 6 5 0 5 6 1 
1 7 1 5 5 1 7 1 
1 8 8 6 0 6 8 8 1 

ã‚‚ã¨ã®å€¤
1 
1 1 
1 2 1 
1 3 3 1 
1 4 6 4 1 
1 5 10 10 5 1 
1 6 15 20 15 6 1 
1 7 21 35 35 21 7 1 
1 8 28 56 70 56 28 8 1 

</code></pre></div></div>

<h3 id="æ›´æ–°å±¥æ­´-9">æ›´æ–°å±¥æ­´</h3>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/18</td>
      <td style="text-align: left">ä»»æ„modäºŒé …ä¿‚æ•°ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ-1">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/arc012/tasks/arc012_4">ARC012-D</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/arc012/submissions/39798965">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-äºŒæ¬¡å…ƒé…åˆ—ã®å›è»¢-">ğŸ”´ äºŒæ¬¡å…ƒé…åˆ—ã®å›è»¢ ğŸ”´</h1>

<p>äºŒæ¬¡å…ƒé…åˆ—\(A\)ã‚’ä¸ãˆã‚‹ã¨ã€\(A\)ã‚’åæ™‚è¨ˆå›ã‚Šã«å›è»¢ã•ã›è¿”ã™</p>

<p>ç¬¬äºŒå¤‰æ•°ã‚’\(true\)ã«ã™ã‚‹ã¨æ™‚è¨ˆå›ã‚Šã«å›è»¢ã•ã›ã‚‹</p>

<p>ã‚‚ã—\(A[i]\)ã®é•·ã•ãŒæƒã£ã¦ã„ãªã„å ´åˆã¯æœ€ã‚‚é•·ã„ã‚‚ã®ã«åˆã‚ã›ã€è¶³ã‚Šãªã„éƒ¨åˆ†ã¯ç¬¬ä¸‰å¤‰æ•°ã®å€¤(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯\(0\))ã§åŸ‹ã‚ã‚‹</p>

<p>è¨ˆç®—é‡ã¯é…åˆ—ã‚’\(N\)è¡Œ\(M\)åˆ—ã¨ã—ã¦\(ÎŸ(NM)\)</p>

<p><a href="">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">bool</span> <span class="n">clockwise</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="kt">char</span> <span class="n">leading</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">A</span><span class="p">;</span>
    
    <span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">M</span><span class="p">,(</span><span class="kt">int</span><span class="p">)</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">());</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">B</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">leading</span><span class="p">));</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">clockwise</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">B</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">B</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-19">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-19">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">bool</span> <span class="n">clockwise</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="kt">char</span> <span class="n">leading</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span><span class="p">{</span>
        <span class="p">{</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">},</span>
        <span class="p">{</span><span class="sc">'d'</span><span class="p">,</span><span class="sc">'e'</span><span class="p">,</span><span class="sc">'f'</span><span class="p">},</span>
        <span class="p">{</span><span class="sc">'g'</span><span class="p">,</span><span class="sc">'h'</span><span class="p">,</span><span class="sc">'i'</span><span class="p">}</span>
    <span class="p">};</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"å›è»¢ãªã—"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"åæ™‚è¨ˆå›ã‚Š"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">counter</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">counter</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">counter</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;</span> <span class="n">clockwise</span> <span class="o">=</span> <span class="n">vector2D_rotate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"æ™‚è¨ˆå›ã‚Š"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">clockwise</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">clockwise</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">clockwise</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-19">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å›è»¢ãªã—
a b c 
d e f 
g h i 

åæ™‚è¨ˆå›ã‚Š
c f i 
b e h 
a d g 

æ™‚è¨ˆå›ã‚Š
g d a 
h e b 
i f c
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-10">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/09/12</td>
      <td style="text-align: left">äºŒæ¬¡å…ƒé…åˆ—ã®å›è»¢ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®-">ğŸ”´ ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸® ğŸ”´</h1>

<p>æ–‡å­—åˆ—\(S\)ã‚’ä¸ãˆã‚‹ã¨ã€\(S\)ã‚’ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®(é€£é•·åœ§ç¸®)ã—ã¦è¿”ã™</p>

<p>ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã¨ã¯ã€æ–‡å­—åˆ—ã‚’ã€Œæ–‡å­—ã¨ã€ãã‚ŒãŒã„ãã¤ç¶šãã‹ã€ã®çµ„ã«å¤‰æ›ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹
ã¡ãªã¿ã«å¯é€†å¤‰æ›</p>

<p>è¨ˆç®—é‡ã¯\(ÎŸ(\vert S \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/runlength%20encode.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">});</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">R</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">second</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-20">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-20">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">S</span> <span class="o">=</span> <span class="s">"abbcccddeeeacddd"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">runlength_encode</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">R</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-20">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a 1
b 2
c 3
d 2
e 3
a 1
c 1
d 3
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-11">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/07/10</td>
      <td style="text-align: left">ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ-2">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc259/tasks/abc259_c">ABC259-C</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc259/submissions/33129519">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-åè§’ã‚½ãƒ¼ãƒˆ-">ğŸ”´ åè§’ã‚½ãƒ¼ãƒˆ ğŸ”´</h1>

<p>æ•°åˆ—\(A\)ã‚’ä¸ãˆã‚‹ã¨ã€ä»¥ä¸‹ã®ä¸¦ã¹æ–¹ã§\(A\)ã‚’ã‚½ãƒ¼ãƒˆã—ã¦è¿”ã™
åŸºæº–ã‚’ç¬¬äºŒå¤‰æ•°\(d\)(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯\((1,0)\))ã§å®šã‚ã‚‹ã“ã¨ã‚‚ã§ãã‚‹</p>

<ul>
  <li>åè§’(ã®ã†ã¡ã€\([\arg(d),\arg(d)+2\pi)\)ã§ã‚ã‚‹ã‚‚ã®)ãŒå°ã•ã„é †ã«ä¸¦ã¹ã‚‹</li>
  <li>ãã‚ŒãŒåŒã˜å ´åˆã€çµ¶å¯¾å€¤ãŒå°ã•ã„é †ã«ä¸¦ã¹ã‚‹</li>
  <li>\((0,0)\)ãŒå«ã¾ã‚Œã‚‹å ´åˆassertã—ã¦åœæ­¢ã™ã‚‹</li>
</ul>

<p>è¨ˆç®—é‡ã¯\(ÎŸ(\vert A \vert log \vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/arg%20sort.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">d</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">gcd</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
    <span class="n">d</span><span class="p">.</span><span class="n">first</span><span class="o">/=</span><span class="n">g</span><span class="p">;</span><span class="n">d</span><span class="p">.</span><span class="n">second</span><span class="o">/=</span><span class="n">g</span><span class="p">;</span>
    <span class="n">A</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">A</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">){</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">b</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">!=</span><span class="n">b</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">&lt;</span><span class="n">b</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">));</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
           <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="o">*</span><span class="n">y</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">d</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">B</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">B</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-21">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-21">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">//Aã‚’(1,0)ã‚’åŸºæº–ã«ã‚½ãƒ¼ãƒˆ</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span> 
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//Aã‚’(-1,1)ã‚’åŸºæº–ã«ã‚½ãƒ¼ãƒˆ</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">arg_sort</span><span class="p">(</span><span class="n">A</span><span class="p">,{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"("</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span> 
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="å‡ºåŠ›-21">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(3,0) (2,1) (1,2) (0,3) (-1,2) (-2,1) (-3,0) (-2,-1) (-1,-2) (0,-3) (1,-2) (2,-1) 
(-2,1) (-3,0) (-2,-1) (-1,-2) (0,-3) (1,-2) (2,-1) (3,0) (2,1) (1,2) (0,3) (-1,2) 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-12">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/10/31</td>
      <td style="text-align: left">åè§’ã‚½ãƒ¼ãƒˆã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-åå¾©å†™åƒ-">ğŸ”´ åå¾©å†™åƒ ğŸ”´</h1>

<p>init</p>
<ul>
  <li>æ•°åˆ—\(F\)ã‚’ä¸ãˆã‚‹ã¨ã€ã™ã¹ã¦ã®æ•´æ•° \(x (0 \leq x &lt; \vert F \vert)\) ã«ã¤ã„ã¦ \(f(x) = F[x]\) ã¨ãªã‚‹ã‚ˆã†ã«é–¢æ•° \(f\) ã‚’è¨­å®šã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(N=\vert F \vert\)ã¨ã—ã€\(ÎŸ(N)\)</li>
</ul>

<p>iterated_function</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>solve</p>
<ul>
  <li>æ•´æ•° \(x\) ã§ã‚ã£ã¦\(0 \leq x &lt; N\) ã‚’æº€ãŸã™ã‚ˆã†ãªã‚‚ã®ã¨éè² æ•´æ•° \(k\) ã‚’ä¸ãˆã‚‹ã¨ã€\(\overbrace{f(f(\cdots f}^{k}(x)))\) ã‚’æ±‚ã‚ã€è¿”ã™</li>
  <li>ã‚‚ã—\(k = 0\)ãªã‚‰\(x\)ãã®ã‚‚ã®ã‚’è¿”ã™</li>
  <li>ç¯„å›²å¤–ãªã‚‰\(-1\)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N \log k)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/iterated%20function.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">iterated_function</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">N</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">){</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">64</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
    <span class="p">}</span>

    <span class="n">iterated_function</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span> <span class="o">||</span> <span class="n">k</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;(</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">((</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">y</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-22">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-22">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">iterated_function</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">iterated_function</span> <span class="n">func</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0ã‹ã‚‰kå›è¾¿ã£ãŸã¨ãã®é ‚ç‚¹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;=</span><span class="mi">15</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">func</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"å„é ‚ç‚¹ã‹ã‚‰3å›è¾¿ã£ãŸã¨ãã®é ‚ç‚¹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">func</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-22">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0ã‹ã‚‰kå›è¾¿ã£ãŸã¨ãã®é ‚ç‚¹
0 1 2 3 4 5 2 3 4 5 2 3 4 5 2 3 

å„é ‚ç‚¹ã‹ã‚‰3å›è¾¿ã£ãŸã¨ãã®é ‚ç‚¹
3 4 5 2 3 4 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-13">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/07/03</td>
      <td style="text-align: left">åå¾©å†™åƒã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ-3">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc167/tasks/abc167_d">ABC167-D</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc167/submissions/32945330">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ã‚¹ãƒ©ã‚¤ãƒ‰æœ€å°å€¤-">ğŸ”´ ã‚¹ãƒ©ã‚¤ãƒ‰æœ€å°å€¤ ğŸ”´</h1>

<p>æ•°åˆ—\(A\)ã¨æ•´æ•°\(K\)ã‚’ä¸ãˆã‚‹ã¨ã€ä»¥ä¸‹ã®æ•°å¼ã‚’æº€ãŸã™è¦ç´ æ•°ãŒ\(\vert A \vert -K+1\)ã®æ•°åˆ—\(R\)ã‚’æ§‹æˆã—ã€è¿”ã™</p>

\[R_i = min(A_i , A_{i+1} , ... , A_{i+K-1})\]

<p>è¨ˆç®—é‡ã¯\(O(\vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/slide%20minimum.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">int</span> <span class="n">K</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">D</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">A</span><span class="p">[</span><span class="n">D</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span><span class="o">&gt;=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span><span class="n">D</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();}</span>
        <span class="n">D</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">D</span><span class="p">.</span><span class="n">front</span><span class="p">()]);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">==</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">D</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-23">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-23">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="kt">int</span> <span class="n">K</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    
    <span class="n">B</span> <span class="o">=</span> <span class="n">slide_minimum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">K</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-23">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 1 1 1 2 2 2 3 3 3 5 7 7 3 2 2 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-14">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/23</td>
      <td style="text-align: left">ã‚¹ãƒ©ã‚¤ãƒ‰æœ€å°å€¤ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-åº§æ¨™åœ§ç¸®-">ğŸ”´ åº§æ¨™åœ§ç¸® ğŸ”´</h1>

<p>init</p>
<ul>
  <li>æ•°åˆ—\(A\)ã‚’ä¸ãˆã‚‹ã¨ã€ã‚¯ãƒ©ã‚¹ã‚’\(A\)ã§åˆæœŸåŒ–ã™ã‚‹</li>
  <li>ã“ã®ã¨ãã€\(A\)ã®å…¨ã¦ã®\(2\)ã¤ã®è¦ç´ ã«ã¤ã„ã¦å¤§å°é–¢ä¿‚ãŒç¶­æŒã•ã‚Œã€ã‹ã¤indexã®æœ€å¤§å€¤ãŒæœ€å°ã«ãªã‚‹ã‚ˆã†ã«\(A\)ã®å„è¦ç´ ã«indexã¨ã„ã†éè² æ•´æ•°ãŒå‰²ã‚ŠæŒ¯ã‚‰ã‚Œã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(N=\vert A \vert\)ã¨ã—ã€\(ÎŸ(NlogN)\)</li>
</ul>

<p>compress</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>size</p>
<ul>
  <li>initã§ä¸ãˆã‚‰ã‚ŒãŸæ•°åˆ—ã®ä¸­ã«å«ã¾ã‚Œã‚‹å€¤ã®ç¨®é¡æ•°ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(1)\)</li>
</ul>

<p>index</p>
<ul>
  <li>å€¤ã‚’ä¸ãˆã‚‹ã¨ã€ãã®å€¤ã«å¯¾å¿œã™ã‚‹indexã‚’è¿”ã™</li>
  <li>ã‚‚ã—æ•°åˆ—ã«å­˜åœ¨ã—ãªã„å€¤ãŒä¸ãˆã‚‰ã‚ŒãŸã‚‰ã€æ•°åˆ—ã«å­˜åœ¨ã™ã‚‹å€¤ã®ä¸­ã§ã€ä¸ãˆã‚‰ã‚ŒãŸå€¤ã‚ˆã‚Šå°ã•ã„æœ€å¤§ã®å€¤ã«ã¤ã„ã¦ã®indexã‚’è¿”ã™(ã¤ã¾ã‚Šã€å°ã•ã„å€¤ã«å¯„ã›ã‚‹)</li>
  <li>ã‚‚ã—åˆ—ã®ã„ã‹ãªã‚‹å€¤ã‚ˆã‚Šã‚‚å°ã•ã‘ã‚Œã°\(-1\)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯initã®\(N\)ã‚’ç”¨ã„ã¦ã€\(ÎŸ(logN)\)</li>
</ul>

<p>value</p>
<ul>
  <li>indexã‚’ä¸ãˆã‚‹ã¨å€¤ã‚’è¿”ã™</li>
  <li>ç¯„å›²å¤–ãªã‚‰\(0\)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/coordinate%20compression.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">compress</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">E</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="n">E</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">sort</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">A</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]){</span>
                <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">compress</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">size</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">value</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">E</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
            <span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">index</span><span class="p">(</span><span class="kt">int</span> <span class="n">X</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">upper_bound</span><span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">E</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">X</span><span class="p">))</span><span class="o">-</span><span class="n">E</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-24">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-24">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">compress</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">};</span>
    <span class="n">compress</span> <span class="n">zaatsu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"uniqueãªè¦ç´ ã®å€‹æ•°"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Aã®å„è¦ç´ ã«å¯¾å¿œã™ã‚‹æ•°"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"0~7ã«å¯¾å¿œã™ã‚‹è¦ç´ "</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">zaatsu</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">zaatsu</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-24">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uniqueãªè¦ç´ ã®å€‹æ•°
8

Aã®å„è¦ç´ ã«å¯¾å¿œã™ã‚‹æ•°
0 1 2 3 4 5 6 7 

0~7ã«å¯¾å¿œã™ã‚‹è¦ç´ 
1 2 4 8 16 32 64 128 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-15">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/05/20</td>
      <td style="text-align: left">mapã§å‡¦ç†ã—vectorã§è¿”ã™å½¢å¼ã‹ã‚‰ã€classåŒ–ã—äºŒåˆ†æ¢ç´¢ã‚’è¡Œã†å½¢å¼ã«å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">åº§æ¨™åœ§ç¸®ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-æœ€é•·å¢—åŠ éƒ¨åˆ†åˆ—-">ğŸ”´ æœ€é•·å¢—åŠ éƒ¨åˆ†åˆ— ğŸ”´</h1>

<p>æ•°åˆ—\(A\)ã‚’ä¸ãˆã‚‹ã¨ã€\(A\)ã®æœ€é•·å¢—åŠ éƒ¨åˆ†åˆ—ã®é•·ã•ã‚’æ±‚ã‚ã€long longã§è¿”ã™</p>

<p>è¨ˆç®—é‡ã¯\(ÎŸ(\vert A \vert log \vert A \vert)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/longest%20increasing%20subsequence.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="kt">long</span> <span class="nf">LIS</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">pos</span><span class="o">=</span><span class="n">distance</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">D</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="n">D</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
            <span class="n">D</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">D</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">D</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-25">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-25">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">LIS</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">B</span><span class="o">=</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LIS</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LIS</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-25">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3
2
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-16">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">æœ€é•·å¢—åŠ éƒ¨åˆ†åˆ—ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-moã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ -">ğŸ”´ Moã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ğŸ”´</h1>

<p>ã™ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã®ã†ã¡</p>

<p>ã„ãã¤ã‹ã®åŠé–‹åŒºé–“ \([l_i,r_i)\) ã«ã¤ã„ã¦ã®ç­”ãˆã‚’é«˜é€Ÿã«æ±‚ã‚ã‚‹
\([l,r)\) ã§ã®ç­”ãˆãŒã‚ã‹ã£ã¦ã„ã‚‹ã¨ãã€éš£æ¥ã™ã‚‹åŒºé–“ \([l-1,r),[l+1,r),[l,r-1),[l,r+1)\) ã«ã¤ã„ã¦ã®ç­”ãˆãŒé«˜é€Ÿã«ã‚ã‹ã‚‹å ´åˆã«æœ‰åŠ¹</p>

<p>ç¬¬ä¸€å¼•æ•°ã«åŒºé–“å…¨ä½“ã®é•·ã• \(N\) ã€ç¬¬äºŒå¼•æ•°ã«ã‚¯ã‚¨ãƒªã®æ•° \(Q\) ã€ç¬¬ä¸‰å¼•æ•°ã«ã‚¯ã‚¨ãƒªã®ãƒªã‚¹ãƒˆã€ãã—ã¦ç¬¬å››ï½ç¬¬ä¸ƒå¼•æ•°ã«ã¯ãã‚Œãã‚Œ</p>
<ul>
  <li>\([l,r)\) ã®ç­”ãˆã‹ã‚‰ \([l-1,r)\) ã®ç­”ãˆã‚’æ±‚ã‚ã‚‹é–¢æ•°</li>
  <li>\([l,r)\) ã®ç­”ãˆã‹ã‚‰ \([l+1,r)\) ã®ç­”ãˆã‚’æ±‚ã‚ã‚‹é–¢æ•°</li>
  <li>\([l,r)\) ã®ç­”ãˆã‹ã‚‰ \([l,r-1)\) ã®ç­”ãˆã‚’æ±‚ã‚ã‚‹é–¢æ•°</li>
  <li>\([l,r)\) ã®ç­”ãˆã‹ã‚‰ \([l,r+1)\) ã®ç­”ãˆã‚’æ±‚ã‚ã‚‹é–¢æ•°</li>
</ul>

<p>ã‚’ä¸ãˆã‚‹ã¨ã€å„ã‚¯ã‚¨ãƒªã«å¯¾ã—ã¦ã®ç­”ãˆã‚’vectorã§è¿”ã™</p>

<p>è¨ˆç®—é‡ã¯ç¬¬å››ï½ç¬¬ä¸ƒå¼•æ•°ã§ä¸ãˆãŸé–¢æ•°ã®è¨ˆç®—é‡ã‚’ \(f\) ã¨ã™ã‚‹ã¨ \(ÎŸ(Q \log Q + N \sqrt{Q} f)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/mos-algorithm.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Mo</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">X</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">rQ</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">index</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">block</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Ans</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">comp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">A</span><span class="p">.</span><span class="n">first</span><span class="p">]</span><span class="o">!=</span><span class="n">block</span><span class="p">[</span><span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">]){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">A</span><span class="p">.</span><span class="n">first</span><span class="p">]</span><span class="o">&lt;</span><span class="n">block</span><span class="p">[</span><span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">second</span> <span class="o">!=</span> <span class="n">B</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">index</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">index</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

    <span class="n">rQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">((</span><span class="n">rQ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rQ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">q</span><span class="p">)</span><span class="n">rQ</span><span class="o">++</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">rQ</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">now</span> <span class="o">+=</span> <span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="n">rQ</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">rQ</span><span class="p">);</span>
        <span class="n">block</span><span class="p">[</span><span class="n">now</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">Y</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="n">e</span><span class="o">:</span><span class="n">index</span><span class="p">){</span>
        <span class="n">Y</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
        <span class="n">now</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">Y</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">auto</span> <span class="n">a</span><span class="p">,</span> <span class="k">auto</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">comp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);});</span>

    <span class="kt">int</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        
        <span class="k">while</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">){</span>
            <span class="n">lm</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">L</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">){</span>
            <span class="n">rp</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">R</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">L</span> <span class="o">&lt;</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">){</span>
            <span class="n">lp</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">L</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">){</span>
            <span class="n">rm</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Result</span><span class="p">);</span>
            <span class="n">R</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">:</span><span class="n">index</span><span class="p">[</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">]]){</span>
            <span class="n">Ans</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Result</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="k">return</span> <span class="n">Ans</span><span class="p">;</span>

    <span class="c1">//lm(i): [i,r)ã‚’[i-1,r)ã«ã™ã‚‹</span>
    <span class="c1">//lp(i): [i,r)ã‚’[i+1,r)ã«ã™ã‚‹</span>
    <span class="c1">//rm(i): [i,r)ã‚’[i,r-1)ã«ã™ã‚‹</span>
    <span class="c1">//rp(i): [i,r)ã‚’[i,r+1)ã«ã™ã‚‹</span>

<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-26">ä½¿ç”¨ä¾‹</h2>
<hr />

<p><br />
\(A = (1,2,3,4,5)\) ã® \([l,r)\) ã®å’Œã‚’æ±‚ã‚ã‚‹</p>

<p>ã“ã‚Œã¯ \([l,r)\) ã®å’ŒãŒã‚ã‹ã£ã¦ã„ã‚Œã° \([l-1,r),[l+1,r),[l,r-1),[l,r+1)\) ã®å’ŒãŒ \(O(1)\) ã§ã‚ã‹ã‚‹<br />
ä¾‹ãˆã° \([1,3)\) ã®å’ŒãŒ \(A_1 + A_2 = 2 + 3 = 5\) ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã£ã¦ã„ã‚Œã° \([1,4)\) ã®å’Œã¯ \(5 + A_3 = 5 + 4 = 9\) ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹</p>

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-26">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Mo</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">X</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span><span class="p">,</span> 
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">LR</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
        <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span>
    <span class="p">};</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">lp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rm</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">rp</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">};</span>


    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Ans</span> <span class="o">=</span> <span class="n">Mo</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">LR</span><span class="p">,</span><span class="n">lm</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">rm</span><span class="p">,</span><span class="n">rp</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"["</span> <span class="o">&lt;&lt;</span> <span class="n">LR</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">","</span> <span class="o">&lt;&lt;</span> <span class="n">LR</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">")  "</span> <span class="o">&lt;&lt;</span> <span class="n">Ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-26">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0,1)  1
[0,2)  3
[0,3)  6
[0,4)  10
[0,5)  15
[1,2)  2
[1,3)  5
[1,4)  9
[1,5)  14
[2,3)  3
[2,4)  7
[2,5)  12
[3,4)  4
[3,5)  9
[4,5)  5

</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-17">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/13</td>
      <td style="text-align: left">Moã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ-4">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc293/tasks/abc293_g">ABC293-G</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc293/submissions/39690323">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒãƒƒã‚·ãƒ¥-">ğŸ”´ ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒãƒƒã‚·ãƒ¥ ğŸ”´</h1>

<p>MOD \(2^{61}-1\)ã¨\(2\)åŸºåº•ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€€<a href="https://trap.jp/post/900/">ä¾‹ã®è¨˜äº‹</a>ã¯ã„ã£ãŸã„ï½¥ï½¥ï½¥<br />
åŸºåº•ã¯ã‚³ãƒ¼ãƒ‰ä¸­ã®Baseã‚’ç›´ã«ã„ã˜ã‚Œã°å¤‰æ›´ã§ãã¾ã™ ã“ã“ã‚µãƒãƒ¼ãƒˆã—ãŸæ–¹ãŒã„ã„ã®ã‹ãªï¼Ÿ</p>

<p>init</p>
<ul>
  <li><del>æ–‡å­—åˆ—</del> long longã®vector \(S\) ã‚’ä¸ãˆã‚‹ã¨ã€å‰è¨ˆç®—ã¨ã—ã¦\(S\)ã‚’ãƒãƒƒã‚·ãƒ¥ã™ã‚‹ä»–ã€getã®è¨ˆç®—ã§ä½¿ç”¨ã™ã‚‹æ•°å€¤ã‚’è¨ˆç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯åŸºåº•ã®æ•°ã‚’\(b\)ã¨ã—ã¦ã€\(ÎŸ(b\vert S \vert)\)</li>
</ul>

<p>rollinghash</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>get</p>
<ul>
  <li>åŠé–‹åŒºé–“\([l,r)\)ã‚’ä¸ãˆã‚‹ã¨ã€\(S\)ã®\([l,r)\)æ–‡å­—ç›®ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯åŸºåº•ã®æ•°ã‚’\(b\)ã¨ã—ã¦ã€\(ÎŸ(b)\)</li>
</ul>

<p>instant</p>
<ul>
  <li><del>æ–‡å­—åˆ—</del> long longã®vector \(P\)ã‚’ä¸ãˆã‚‹ã¨ã€initã«ä¸ãˆãŸ\(S\)ã¨ã¯é–¢ä¿‚ãªã\(P\)ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¨ˆç®—ã—è¿”ã™</li>
  <li>ãŸã è¿”ã™ã ã‘ã§ã€initã§æƒãˆãŸæƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ãªã„</li>
  <li>è¨ˆç®—é‡ã¯åŸºåº•ã®æ•°ã‚’\(b\)ã¨ã—ã¦ã€\(ÎŸ(b\vert P \vert)\)</li>
</ul>

<p>connect</p>
<ul>
  <li><del>æ–‡å­—åˆ—</del> long longã®vector \(P,Q\) ã®ãƒãƒƒã‚·ãƒ¥çµæœã¨åˆ—ã®é•·ã•ã‚’ä¸ãˆã‚‹ã¨ã€initã«ä¸ãˆãŸ\(S\)ã¨ã¯é–¢ä¿‚ãªã\(P,Q\)ã®çµåˆvector\(P+Q\)ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¨ˆç®—ã—è¿”ã™</li>
  <li>ãŸã è¿”ã™ã ã‘ã§ã€initã§æƒãˆãŸæƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ãªã„</li>
  <li>è¨ˆç®—é‡ã¯åŸºåº•ã®æ•°ã‚’\(b\)ã€\(P\)ã®é•·ã•ã‚’\(p\)ã¨ã—ã¦ã€\(ÎŸ(b \log{p})\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/rollinghash.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">rollinghash</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">mod</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span> <span class="o">&lt;&lt;</span> <span class="mi">61</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Base</span> <span class="o">=</span> <span class="p">{</span><span class="mi">12345</span><span class="p">,</span><span class="mi">10000000</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">BaseInv</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">BaseInvExp</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">product</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">b2</span> <span class="o">=</span> <span class="n">b</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">s</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a1</span><span class="o">*</span><span class="n">b1</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">b2</span> <span class="o">+</span> <span class="n">b1</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">%</span><span class="n">m</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s1</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">s2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">b2</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">power</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">e</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">r</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="p">}</span>
                <span class="n">b</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">e</span> <span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">H</span><span class="p">,</span><span class="n">Hsum</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">cs</span><span class="p">){</span>
        <span class="n">S</span><span class="o">=</span><span class="n">cs</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        
        <span class="n">BaseInv</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">BaseInvExp</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">H</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="n">Hsum</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="c1">//é€†å…ƒ</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BaseInv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">power</span><span class="p">(</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mod</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">BaseInv</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//æœ¬ä½“</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">);</span>
                <span class="n">b</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">//ç´¯ç©å’Œ</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">rollinghash</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">C</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">-</span><span class="n">Hsum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="n">mod</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="n">g</span><span class="o">=</span><span class="n">product</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">BaseInvExp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]);</span>
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">instant</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">))</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">connect</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">ps</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">qs</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Base</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">power</span><span class="p">(</span><span class="n">Base</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ps</span><span class="p">))</span><span class="o">+</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">qs</span><span class="o">==</span><span class="n">qs</span><span class="p">);</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-27">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-27">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">rollinghash</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="n">rollinghash</span> <span class="n">rolihash</span><span class="p">({</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">,</span><span class="sc">'a'</span><span class="p">,</span><span class="sc">'b'</span><span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">ã®[0,2)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š</span><span class="se">\"</span><span class="s">ab</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">ã®[1,4)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š</span><span class="se">\"</span><span class="s">bca</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">abcab</span><span class="se">\"</span><span class="s">ã®[3,5)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š</span><span class="se">\"</span><span class="s">ab</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">c</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">bc</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">instant</span><span class="p">({</span><span class="sc">'b'</span><span class="p">,</span><span class="sc">'c'</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">d</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">a</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">instant</span><span class="p">({</span><span class="sc">'a'</span><span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">bc</span><span class="se">\"</span><span class="s">ã¨</span><span class="se">\"</span><span class="s">a</span><span class="se">\"</span><span class="s">ã®çµåˆã€ã¤ã¾ã‚Š</span><span class="se">\"</span><span class="s">bca</span><span class="se">\"</span><span class="s">ã®ãƒãƒƒã‚·ãƒ¥å€¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">rolihash</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-27">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"abcab"ã®[0,2)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š"ab"ã®ãƒãƒƒã‚·ãƒ¥å€¤
2444507 1980000197 

"abcab"ã®[1,4)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š"bca"ã®ãƒãƒƒã‚·ãƒ¥å€¤
30025064778 19700001990000198 

"abcab"ã®[3,5)æ–‡å­—ç›®ã€ã¤ã¾ã‚Š"ab"ã®ãƒãƒƒã‚·ãƒ¥å€¤
2444507 1980000197 

"bc"ã®ãƒãƒƒã‚·ãƒ¥å€¤
2456853 1990000198 

"a"ã®ãƒãƒƒã‚·ãƒ¥å€¤
197 197 

"bc"ã¨"a"ã®çµåˆã€ã¤ã¾ã‚Š"bca"ã®ãƒãƒƒã‚·ãƒ¥å€¤
30025064778 19700001990000198 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-18">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/25</td>
      <td style="text-align: left">connectã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2023/03/25</td>
      <td style="text-align: left">ãƒãƒƒã‚·ãƒ¥å¯¾è±¡ã‚’stringã‹ã‚‰vector<long long="">ã«å¤‰æ›´</long></td>
    </tr>
    <tr>
      <td style="text-align: center">2022/06/26</td>
      <td style="text-align: left">constexprã«ã‚ˆã‚‹æœ€é©åŒ–ã‚’å®Ÿè¡Œ</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/08/31</td>
      <td style="text-align: left">instantã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/04/01</td>
      <td style="text-align: left">ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒãƒƒã‚·ãƒ¥ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<h2 id="ç¢ºèªã—ãŸå•é¡Œ-5">ç¢ºèªã—ãŸå•é¡Œ</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: center">å•é¡Œ</th>
      <th style="text-align: left">æå‡º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://atcoder.jp/contests/abc141/tasks/abc141_e">ABC141-E</a></td>
      <td style="text-align: left"><a href="https://atcoder.jp/contests/abc141/submissions/39997036">æå‡º</a></td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•-">ğŸ”´ ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³• ğŸ”´</h1>

<p>init</p>
<ul>
  <li>ç„¡å‘ã‚°ãƒ©ãƒ•ã‚’ã€é ‚ç‚¹æ•°\(N\)ã¨ã€è¾ºã®å§‹ç‚¹ã¨çµ‚ç‚¹ã¨ã‚³ã‚¹ãƒˆã‚’è¡¨ç¾ã—ãŸpair&lt;pair&lt;int,int&gt;,long long&gt;ã®vectorã¨ã—ã¦ä¸ãˆã‚‹ã€‚</li>
  <li>ã™ã‚‹ã¨ã€ã‚°ãƒ©ãƒ•ã‚’solve()ãŒæ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚‹</li>
  <li>å¤šå§‹ç‚¹ãªã©ã§ä½•å›ã‚‚å›ã™å ´åˆã€initã®å®Ÿè¡Œã¯\(1\)å›ã§ã‚ˆã„</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\vert E \vert)\)</li>
</ul>

<p>Dijkstra</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>solve</p>
<ul>
  <li>initã§ã§ããŸã‚°ãƒ©ãƒ•ã«å¯¾ã—ã€ä¸ãˆã‚‰ã‚ŒãŸ\(s\)ã‚’å§‹ç‚¹ã¨ã—ã¦ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã‚’å®Ÿè¡Œã™ã‚‹</li>
  <li>å¾—ã‚‰ã‚ŒãŸæœ€å°ã‚³ã‚¹ãƒˆã‚’è¦ç´ æ•°ãŒ\(V\)ã®vectorã¨ã—ã¦è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ((E+V)logV)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/Dijkstra.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dijkstra</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">P</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;&gt;</span> <span class="n">que</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//é ‚ç‚¹æ•°ã‚’æ±ºå®šã™ã‚‹</span>
        <span class="n">V</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        
        <span class="c1">//è¾ºé›†åˆã‚’æ‰±ã„ã‚„ã™ã„å½¢å¼ã«å¤‰æ›ã™ã‚‹</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">from</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">cost</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">cost</span><span class="p">,</span><span class="n">to</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">Dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="c1">//INFã§åˆæœŸåŒ–ã™ã‚‹</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">INF</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">});</span>
        <span class="c1">//queã¯{cost,to}ã‚’ã‚³ã‚¹ãƒˆãŒå°ã•ã„é †ã«å‡ºã™</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="n">P</span> <span class="n">p</span> <span class="o">=</span> <span class="n">que</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
            <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&lt;</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">P</span> <span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">]</span><span class="o">&gt;</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">){</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
                    <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">],</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="p">});</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-28">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-28">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Dijkstra</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">Dijkstra</span> <span class="n">dijkstra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">E</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-28">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 3 7 11 
2305843009213693952 0 2 6 10 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-19">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ /ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/02/12</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£/ã„ãã¤ã‹ã®è¡¨è¨˜å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•-">ğŸ”´ ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³• ğŸ”´</h1>

<p>init</p>
<ul>
  <li>ç„¡å‘ã‚°ãƒ©ãƒ•ã‚’ã€è¾ºã®å§‹ç‚¹ã¨çµ‚ç‚¹ã¨ã‚³ã‚¹ãƒˆã‚’è¡¨ç¾ã—ãŸpair&lt;pair&lt;int,int&gt;,long long&gt;ã®vectorã¨ã—ã¦ä¸ãˆã‚‹ã€‚</li>
  <li>ã™ã‚‹ã¨ã€ã‚°ãƒ©ãƒ•ã‚’solve()ãŒæ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚‹</li>
  <li>å¤šå§‹ç‚¹ãªã©ã§ä½•å›ã‚‚å›ã™å ´åˆã€initã®å®Ÿè¡Œã¯\(1\)å›ã§ã‚ˆã„</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(max(E,V))\)</li>
</ul>

<p>BellmanFord</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>solve</p>
<ul>
  <li>initã§ã§ããŸã‚°ãƒ©ãƒ•ã«å¯¾ã—ã€ä¸ãˆã‚‰ã‚ŒãŸ\(s\)ã‚’å§‹ç‚¹ã¨ã—ã¦ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã‚’å®Ÿè¡Œã™ã‚‹</li>
  <li>å¾—ã‚‰ã‚ŒãŸæœ€å°ã‚³ã‚¹ãƒˆã‚’è¦ç´ æ•°ãŒ\(V\)ã®vectorã¨ã—ã¦è¿”ã™</li>
  <li>vectorã®è¦ç´ ã¯pair&lt;long long,bool&gt;ã§ã‚ã‚‹ã€€firstã¯æœ€å°ã‚³ã‚¹ãƒˆã‚’è¡¨ã—ã¦ãŠã‚Šã€secondãŒtrueã®å ´åˆæœ€å°ã‚³ã‚¹ãƒˆãŒå­˜åœ¨ã›ãšfirstã®å€¤ã¯é©å½“</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(VE)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/BellmanFord.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BellmanFord</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">E</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//è¾ºæ•°ã‚’ã‚‚ã¨ã‚ã‚‹ã€€</span>
        <span class="n">E</span><span class="o">=</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="c1">//é ‚ç‚¹æ•°ã‚’æ±ºå®šã™ã‚‹</span>
        <span class="n">V</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
        <span class="n">es</span><span class="o">=</span><span class="n">edge</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">BellmanFord</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="c1">//INFã§åˆæœŸåŒ–ã™ã‚‹</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">INF</span><span class="p">,</span><span class="nb">false</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">].</span><span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
             <span class="kt">bool</span> <span class="n">update</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">P</span> <span class="n">k</span><span class="o">=</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">!=</span><span class="n">INF</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">first</span><span class="o">&gt;</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="n">k</span><span class="p">.</span><span class="n">second</span><span class="p">){</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">first</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="n">k</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">V</span><span class="p">){</span>
                        <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">second</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="n">update</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">update</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-29">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-29">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">BellmanFord</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">BellmanFord</span> <span class="n">bellmanford</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">E</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">bellmanford</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-INF"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">bool</span><span class="o">&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">bellmanford</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"-INF"</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-29">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 3 7 11 
2305843009213693952 0 2 6 10 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-20">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£/ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/04</td>
      <td style="text-align: left">ãƒ™ãƒ«ãƒãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰æ³•ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ã‚¯ãƒ©ã‚¹ã‚«ãƒ«æ³•-">ğŸ”´ ã‚¯ãƒ©ã‚¹ã‚«ãƒ«æ³• ğŸ”´</h1>

<p>ç„¡å‘ã‚°ãƒ©ãƒ•ã‚’ã€è¾ºã®å§‹ç‚¹ã¨çµ‚ç‚¹ã¨ã‚³ã‚¹ãƒˆã‚’è¡¨ç¾ã—ãŸpair&lt;pair&lt;int,int&gt;,long long&gt;ã®vectorã¨ã—ã¦ä¸ãˆã‚‹ã€‚</p>

<p>ã™ã‚‹ã¨ã€ã‚³ã‚¹ãƒˆã®å’ŒãŒæœ€å°ã«ãªã‚‹ã‚ˆã†ãªå…¨åŸŸæœ¨ã‚’ä¸€ã¤æ§‹æˆã—ã€ãã®æœ¨ã‚’æ§‹æˆã™ã‚‹è¾ºã‚’vectorã¨ã—ã¦è¿”ã™</p>

<p>è¾ºãŒã¤ãªã\(2\)é ‚ç‚¹ãŒé€£çµã‹ã©ã†ã‹ã‚’<a href="./unionfind">UnionFind</a>ã‚’ç”¨ã„ã¦åˆ¤å®šã—ã¦ã„ã‚‹</p>

<p>è¨ˆç®—é‡ã¯\(ÎŸ(ElogE)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/Kruskal.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Kruskal</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">V</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">;</span>
    
    <span class="kt">bool</span> <span class="n">comp</span><span class="p">(</span><span class="n">P</span> <span class="n">F</span><span class="p">,</span><span class="n">P</span> <span class="n">G</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">F</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;</span><span class="n">G</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">solve</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="c1">//é ‚ç‚¹æ•°ã‚’æ±ºå®šã™ã‚‹</span>
        <span class="n">V</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//è¾ºæ•°ã‚’ã‚‚ã¨ã‚ã‚‹ã€€</span>
        <span class="n">E</span><span class="o">=</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="c1">//unionfindã‚’åˆæœŸåŒ–ã™ã‚‹</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//è¾ºã‚’ã‚½ãƒ¼ãƒˆã—ã¦ä»£å…¥ã—ã¦ãŠã</span>
        <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">edge</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">edge</span><span class="p">.</span><span class="n">end</span><span class="p">(),[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">P</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span> <span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">comp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);});</span>
        <span class="n">es</span><span class="o">=</span><span class="n">edge</span><span class="p">;</span>
        
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">same</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">)){</span>
                <span class="n">unite</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
                <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-30">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-30">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Kruskal</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">10000</span><span class="p">});</span>
    
    <span class="n">Kruskal</span> <span class="n">kruskal</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">kruskal</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">E</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">K</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  "</span> <span class="o">&lt;&lt;</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-30">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1  1
1 2  2
2 3  4
2 4  8
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-21">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/25</td>
      <td style="text-align: left">ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/05</td>
      <td style="text-align: left">ã‚¯ãƒ©ã‚¹ã‚«ãƒ«æ³•ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-äºŒéƒ¨ã‚°ãƒ©ãƒ•åˆ¤å®š-">ğŸ”´ äºŒéƒ¨ã‚°ãƒ©ãƒ•åˆ¤å®š ğŸ”´</h1>

<p>ç„¡å‘ã‚°ãƒ©ãƒ•ã‚’ã€è¾ºã®å§‹ç‚¹ã¨çµ‚ç‚¹ã‚’è¡¨ç¾ã—ãŸpair&lt;int,int&gt;ã®vectorã¨ã—ã¦ä¸ãˆã‚‹ã€‚<br />
ã™ã‚‹ã¨ã€sizeãŒ\(max(ç‚¹ã®ç•ªå·)+1\)ã®vectorãŒè¿”ã£ã¦ãã‚‹ã€‚ã™ã¹ã¦ã®è¦ç´ ã¯\(0\)ã¾ãŸã¯\(1\)ã§ã‚ã‚‹ã€‚<br />
ã“ã‚Œã¯ã€ä¸ãˆã‚‰ã‚ŒãŸã‚°ãƒ©ãƒ•ã‚’äºŒéƒ¨ã‚°ãƒ©ãƒ•ã¨ã—ã¦è¡¨ç¾ã™ã‚‹ã¨ã\(i\)ç•ªç›®ã®è¦ç´ ã¯\(0\)ã¨\(1\)ã©ã¡ã‚‰ã«å±ã™ã‚‹ã‹ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚<br />
ã¾ãŸäºŒéƒ¨ã‚°ãƒ©ãƒ•ã§ãªã„ã¨ãå…¨ã¦ã®è¦ç´ ã¯\(0\)ã§ã‚ã‚‹ã€‚<br />
è¨ˆç®—é‡ã¯\(ÎŸ(V+E)\)</p>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/bipartite%20graph.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="kt">int</span> <span class="n">E</span> <span class="o">=</span> <span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">E</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="p">{};</span>
    <span class="kt">int</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">V</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">es</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">E</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
        <span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">visited</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
        <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="n">visited</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">==</span><span class="n">R</span><span class="p">[</span><span class="n">q</span><span class="p">]){</span>
                    <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span><span class="k">continue</span><span class="p">;</span>
                <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
                <span class="n">R</span><span class="p">[</span><span class="n">es</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">R</span><span class="p">[</span><span class="n">q</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-31">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-31">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span><span class="cm">/*çœç•¥*/</span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">;</span>
    
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>
    <span class="n">E</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">F</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Es</span> <span class="o">=</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">E</span><span class="p">),</span> <span class="n">Fs</span> <span class="o">=</span> <span class="n">bipartite</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Es</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Es</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">Fs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Fs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-31">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 0 1 1 
0 0 0 0 0 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-22">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£/è¨ˆç®—é‡è¡¨è¨˜ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/02</td>
      <td style="text-align: left">äºŒéƒ¨ã‚°ãƒ©ãƒ•åˆ¤å®šã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-æœ¨ã®ç›´å¾„-">ğŸ”´ æœ¨ã®ç›´å¾„ ğŸ”´</h1>

<p>æœ¨ã§ã¯ãªã„ä¸€èˆ¬çš„ãªã‚°ãƒ©ãƒ•ã§ã‚‚è¿‘ä¼¼è§£ãŒå‡ºã‚‹ã‚‰ã—ã„ã‘ã©ãƒã‚§ãƒƒã‚¯ã—ã¦ã¾ã›ã‚“(ãˆï¼Ÿ)</p>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã¨é ‚ç‚¹æ•°\(N\)ã®é‡ã¿ä»˜ãæœ¨ã‚’0-indexedã®vector&lt;pair&lt;pair&lt;int,int&gt;,long longÂ»ã§ä¸ãˆã‚‹ã¨å‰è¨ˆç®—ã‚’ã—ã€æœ¨ã®ç›´å¾„ãŒè¨ˆç®—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>double_sweep</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>vertex</p>
<ul>
  <li>æœ€ã‚‚è·é›¢ãŒå¤§ãããªã‚‹ã‚ˆã†ãªé ‚ç‚¹å¯¾\((u,v)\)ã‚’ä¸€ã¤è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(1)\)</li>
</ul>

<p>pass</p>
<ul>
  <li>\(u\)ã¨\(v\)ã®é–“ã®ãƒ‘ã‚¹ã‚’è¿”ã™</li>
  <li>ã“ã®ã¨ãvectorã®å…ˆé ­ãŒ\(u\)ã€æœ€å¾Œå°¾ãŒ\(v\)ã«ãªã‚‹</li>
  <li>è¨ˆç®—é‡ã¯ãƒ‘ã‚¹ã®é•·ã•ã‚’\(P\)ã¨ã—ã¦ã€\(ÎŸ(P)\)</li>
</ul>

<p>diameter</p>
<ul>
  <li>\(u\)ã¨\(v\)ã®é–“ã®ãƒ‘ã‚¹ã®é‡ã•ã‚’å‡ºåŠ›ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯ãƒ‘ã‚¹ã®é•·ã•ã‚’\(P\)ã¨ã—ã¦ã€\(ÎŸ(P)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/double%20sweep.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">double_sweep</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">parent</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">parent_cost</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">diam</span><span class="p">;</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">temp</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">phase</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="n">temp</span><span class="p">){</span>
                <span class="n">V1</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
            <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="n">temp</span><span class="p">){</span>
                <span class="n">V2</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">E</span><span class="o">:</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">!=</span><span class="n">p</span><span class="p">){</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="n">phase</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
                    <span class="n">parent_cost</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="n">V1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">V2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        
        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">from</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">cost</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
            <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">to</span><span class="p">,</span><span class="n">cost</span><span class="p">});</span>
            <span class="n">G</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">from</span><span class="p">,</span><span class="n">cost</span><span class="p">});</span>
        <span class="p">}</span>
        
        <span class="n">parent</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">parent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">parent_cost</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">parent_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">double_sweep</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vertex</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span><span class="n">V1</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pass</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">V2</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">!=</span><span class="n">V1</span><span class="p">){</span>
            <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
            <span class="n">diam</span> <span class="o">+=</span> <span class="n">parent_cost</span><span class="p">[</span><span class="n">r</span><span class="p">];</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">r</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">R</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">diameter</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">diam</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">pass</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">diam</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-32">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-32">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">double_sweep</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">;</span>
    
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">},</span><span class="mi">8</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">},</span><span class="mi">16</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">},</span><span class="mi">32</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">},</span><span class="mi">64</span><span class="p">});</span>
    
    <span class="n">double_sweep</span> <span class="n">DS</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    
    
    <span class="c1">//ç›´å¾„ã®ç«¯ã®é ‚ç‚¹ã¯6ã¨7</span>
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">vertex</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//ãã®ãƒ‘ã‚¹ã¯6-5-7</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">pass</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//é‡ã•ã®å’Œã¯96</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">D</span> <span class="o">=</span> <span class="n">DS</span><span class="p">.</span><span class="n">diameter</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">D</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-32">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6 7
6 5 7 
96
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-23">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/10/15</td>
      <td style="text-align: left">æœ¨ã®ç›´å¾„ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-æœ€å°å…±é€šç¥–å…ˆ-">ğŸ”´ æœ€å°å…±é€šç¥–å…ˆ ğŸ”´</h1>

<p>init</p>
<ul>
  <li>æ•´æ•°\(r\)ã¨é ‚ç‚¹æ•°\(N\)ã®æœ¨ã‚’0-indexedã®vector&lt;pair&lt;int,intÂ»ã§ä¸ãˆã‚‹ã¨å‰è¨ˆç®—ã‚’ã—ã€\(r\)ã‚’æ ¹ã¨ã™ã‚‹æœ¨ã®LCAãŒè¨ˆç®—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N \log N)\)</li>
</ul>

<p>lowest_common_ancestor</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>climb</p>
<ul>
  <li>\(u\)ã¨\(k\)ã‚’ä¸ãˆã‚‹ã¨ã€é ‚ç‚¹\(u\)ã‹ã‚‰\(k\)å€‹é¡ã£ãŸé ‚ç‚¹ã®ç•ªå·ã‚’è¿”ã™</li>
  <li>ã‚‚ã—æ ¹ã‚’è¶…ãˆã¦ã—ã¾ã£ãŸå ´åˆã¯\(-1\)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\log k)\)</li>
</ul>

<p>lca</p>
<ul>
  <li>\(u\)ã¨\(v\)ã‚’ä¸ãˆã‚‹ã¨é ‚ç‚¹\(u\)ã¨\(v\)ã®LCA(æœ€å°å…±é€šç¥–å…ˆ)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯æœ¨ã®é ‚ç‚¹æ•°\(N\)ã‚’ç”¨ã„ã¦ã€\(ÎŸ(\log N)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/lowest%20common%20ancestor.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">lowest_common_ancestor</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">,</span><span class="n">LOG</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">,</span><span class="n">table</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">depth</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">v</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">p</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span><span class="p">){</span>
        <span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">e</span><span class="o">:</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">!=</span><span class="n">p</span><span class="p">){</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">root</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">LOG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">LOG</span><span class="p">)</span><span class="o">&lt;</span><span class="n">V</span><span class="p">)</span><span class="n">LOG</span><span class="o">++</span><span class="p">;</span>

        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">edge</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">G</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
            <span class="n">G</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="n">table</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">LOG</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">depth</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">LOG</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]][</span><span class="n">j</span><span class="p">];</span>
                <span class="p">}</span>
                
            <span class="p">}</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    
    <span class="n">lowest_common_ancestor</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">root</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    <span class="p">}</span>
    
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">climb</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">u</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">u</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">lca</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">u</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">v</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">depth</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">&gt;</span><span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">);</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">climb</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="n">depth</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span><span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">LOG</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]){</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">table</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-33">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-33">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">lowest_common_ancestor</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;&gt;</span> <span class="n">edge</span><span class="p">;</span>
    
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">});</span>
    <span class="n">edge</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">});</span>
    
    <span class="c1">//0ã‚’æ ¹ã¨ã—ã¦å‰è¨ˆç®—ã™ã‚‹</span>
    <span class="n">lowest_common_ancestor</span> <span class="n">LCA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">edge</span><span class="p">);</span>
    
    <span class="c1">//é ‚ç‚¹6ã‹ã‚‰ä¸€ã¤ãšã¤é¡ã£ãŸã‚‰6â†’5â†’1â†’0ã«ãªã‚Šã€ãã‚Œã‚’è¶…ãˆã‚‹ã¨-1</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">climb</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//é ‚ç‚¹6ã¨é ‚ç‚¹7ã®LCAã¯5</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//é ‚ç‚¹6ã¨é ‚ç‚¹1ã®LCAã¯1</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//é ‚ç‚¹6ã¨é ‚ç‚¹3ã®LCAã¯0</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LCA</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-33">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6 5 1 0 -1 
5
1
0
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-24">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2020/10/10</td>
      <td style="text-align: left">æœ€å°å…±é€šç¥–å…ˆã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ‡ã‚£ãƒ‹ãƒƒãƒ„æ³•-">ğŸ”´ ãƒ‡ã‚£ãƒ‹ãƒƒãƒ„æ³• ğŸ”´</h1>

<p>Dinicã®èª­ã¿æ–¹ã“ã‚Œã§ã„ã„ã®ã‹ãª</p>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€é ‚ç‚¹ã‚’\(N\)å€‹ç”Ÿæˆã—ãƒ•ãƒ­ãƒ¼ã®è¨ˆç®—ã«å¿…è¦ãªãƒ¡ãƒ¢ãƒªã‚’ç¢ºä¿ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>Dinic</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>add</p>
<ul>
  <li>é ‚ç‚¹\(from\)ã‹ã‚‰\(end\)ã«ã‹ã‘ã¦å®¹é‡\(cap\)ã®æœ‰å‘è¾ºã‚’å¼µã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(O(1)\)</li>
</ul>

<p>solve</p>
<ul>
  <li>é ‚ç‚¹\(s\)ã‚’å§‹ç‚¹ã€é ‚ç‚¹\(t\)ã‚’çµ‚ç‚¹ã¨ã—ã¦ãƒ•ãƒ­ãƒ¼ã®æœ€å¤§å€¤ã‚’æ±‚ã‚ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã§ä¸ãˆãŸé ‚ç‚¹ã®æ•°ã‚’\(V\)ã€addã§ä¸ãˆãŸè¾ºã®æ•°ã‚’\(E\)ã¨ã—ã¦\(ÎŸ(E V^2)\)</li>
  <li>å®Ÿéš›ã¯ã“ã‚Œã‚ˆã‚Šã‚‚é«˜é€Ÿã«å‹•ä½œã™ã‚‹</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/algorithm/dinic.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dinic</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="k">struct</span> <span class="nc">edge</span><span class="p">{</span>
        <span class="kt">int</span> <span class="n">end</span><span class="p">;</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">cap</span><span class="p">,</span><span class="n">rev</span><span class="p">;</span>
        
    <span class="p">};</span>
    
    <span class="k">const</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">INF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1LL</span><span class="o">&lt;&lt;</span><span class="mi">61</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">V</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">edge</span><span class="o">&gt;&gt;</span> <span class="n">G</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">level</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">iter</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">Dinic_bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">que</span><span class="p">;</span>
        <span class="n">level</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="n">que</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
            <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">edge</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]</span><span class="o">=</span><span class="n">level</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                    <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">Dinic_dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">==</span><span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="n">f</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">i</span><span class="o">=</span><span class="n">iter</span><span class="p">[</span><span class="n">v</span><span class="p">];</span><span class="n">i</span><span class="o">&lt;</span><span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">edge</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">level</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&lt;</span><span class="n">level</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">]){</span>
                <span class="kt">long</span> <span class="kt">long</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Dinic_dfs</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">cap</span><span class="p">));</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                    <span class="n">e</span><span class="p">.</span><span class="n">cap</span> <span class="o">-=</span> <span class="n">d</span><span class="p">;</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">end</span><span class="p">][</span><span class="n">e</span><span class="p">.</span><span class="n">rev</span><span class="p">].</span><span class="n">cap</span><span class="o">+=</span><span class="n">d</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="n">G</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">G</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">level</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
        <span class="n">iter</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="n">Dinic</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">from</span><span class="p">,</span><span class="kt">int</span> <span class="n">end</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">cap</span><span class="p">){</span>
        <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">edge</span><span class="p">){</span><span class="n">end</span><span class="p">,</span><span class="n">cap</span><span class="p">,(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">G</span><span class="p">[</span><span class="n">end</span><span class="p">].</span><span class="n">size</span><span class="p">()});</span>
        <span class="n">G</span><span class="p">[</span><span class="n">end</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">edge</span><span class="p">){</span><span class="n">from</span><span class="p">,</span><span class="mi">0</span><span class="p">,(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">].</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">});</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">flow</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">Dinic_bfs</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">level</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="n">flow</span><span class="p">;}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">iter</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">;</span>
            <span class="k">while</span><span class="p">((</span><span class="n">f</span><span class="o">=</span><span class="n">Dinic_dfs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">INF</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">flow</span><span class="o">+=</span><span class="n">f</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-34">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-34">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Dinic</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">Dinic</span> <span class="n">dinitz</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dinitz</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    
    <span class="c1">//ã“ã®ã‚°ãƒ©ãƒ•ã§ã¯é ‚ç‚¹0ã‹ã‚‰é ‚ç‚¹4ã¸ã¯æœ€å¤§ã§5ã¤æµã‚Œã‚‹</span>
    <span class="c1">//ä¾‹ãˆã°0-&gt;2-&gt;4ã«2ã¤ã€0-&gt;1-&gt;2-&gt;3-&gt;4ã«1ã¤ã€0-&gt;1-&gt;3-&gt;4ã«2ã¤ãªã©ãŒè€ƒãˆã‚‰ã‚Œã‚‹</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">R</span> <span class="o">=</span> <span class="n">dinitz</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">R</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="å‡ºåŠ›-34">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-25">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">githubãƒªãƒ³ã‚¯ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/11/01</td>
      <td style="text-align: left">ãƒ‡ã‚£ãƒ‹ãƒƒãƒ„æ³•ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨-">ğŸ”´ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ ğŸ”´</h1>

<p>å˜ã«ã‚»ã‚°æœ¨ã¨è¨€ãˆã°ã“ã‚Œã‚’æŒ‡ã™ã€æœ€ã‚‚å˜ç´”ãªã‚»ã‚°æœ¨</p>

<p>init</p>
<ul>
  <li>ç¬¬ä¸€å¼•æ•°ã§æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€è¦ç´ ãŒ\(N\)å€‹å…¥ã‚‹æœ€å°ã‚µã‚¤ã‚ºã®å®Œå…¨äºŒåˆ†æœ¨ã‚’æ§‹æˆã—ã€ã™ã¹ã¦ã®è¦ç´ ã‚’å˜ä½å…ƒã§åˆæœŸåŒ–ã™ã‚‹</li>
  <li>ã¾ãŸç¬¬äºŒï½¥ç¬¬ä¸‰å¼•æ•°ã§ã‚»ã‚°æœ¨ã«ä¹—ã›ã‚‹æ¼”ç®—ã¨ãã®å˜ä½å…ƒã‚’ä¸ãˆã‚‹ã¨ãã®æ¼”ç®—ã‚’ä¹—ã›ã‚‹</li>
  <li>æ¼”ç®—ãŒãƒ¢ãƒã‚¤ãƒ‰ã§ãªã„å ´åˆã®å‹•ä½œã¯ä¿è¨¼ã—ãªã„</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>segmenttree</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>update</p>
<ul>
  <li>\(k\)ç•ªç›®(0-indexed)ã®è¦ç´ ã‚’\(a\)ã§æ›´æ–°ã—ã€ãã‚ŒãŒå½±éŸ¿ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’å…¨ã¦æ›´æ–°ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®\(N\)ã‚’ç”¨ã„ã¦ã€\(ÎŸ(logN)\)</li>
</ul>

<p>query</p>
<ul>
  <li>\([a,b)\)ã®ç¯„å›²å†…ã«ã‚ã‚‹è¦ç´ ã‚’calcã§è¨ˆç®—ã—ãŸçµæœã‚’long longã§è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(log(b-a))\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/segment%20tree.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">segmenttree</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">dat</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">calc</span><span class="p">;</span>
    <span class="n">T</span> <span class="n">identity</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span><span class="p">,</span><span class="n">T</span> <span class="n">Identity</span><span class="p">){</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="n">n</span><span class="o">*=</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">dat</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="n">dat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Identity</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">func</span><span class="p">;</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">segmenttree</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span><span class="p">,</span><span class="n">T</span> <span class="n">Identity</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="n">Identity</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="n">T</span> <span class="n">a</span><span class="p">){</span>
        <span class="n">k</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">dat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="n">dat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">calc</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">dat</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">T</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
        <span class="n">a</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">b</span><span class="o">+=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">L</span><span class="o">=</span> <span class="n">identity</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">identity</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">dat</span><span class="p">[</span><span class="n">a</span><span class="p">]);</span>
                <span class="n">a</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">R</span><span class="p">);</span>
                <span class="n">b</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">R</span><span class="p">;</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-35">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-35">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">segmenttree</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">100000</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">func</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="n">segmenttree</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">segtree</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">segtree</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">segtree</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-35">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>123000
123456
3456
450
6
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-26">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/01/30</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2022/01/30</td>
      <td style="text-align: left">ä»»æ„ã®å‹ã«å¯¾å¿œ</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/10/10</td>
      <td style="text-align: left">ãƒã‚°ã‚’ä¿®æ­£</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒ•ã‚§ãƒ‹ãƒƒã‚¯æœ¨-">ğŸ”´ ãƒ•ã‚§ãƒ‹ãƒƒã‚¯æœ¨ ğŸ”´</h1>

<p>BIT(Binary Indexed Tree)ã¨ã‚‚</p>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€è¦ç´ ãŒ\(N\)å€‹ã®ãƒ•ã‚§ãƒ‹ãƒƒã‚¯æœ¨ã‚’æ§‹æˆã—ã€ã™ã¹ã¦ã®è¦ç´ ã‚’\(0\)ã§åˆæœŸåŒ–ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>Fenwick_tree</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>add</p>
<ul>
  <li>\(a\)ç•ªç›®(0-indexed)ã®è¦ç´ ã«\(w\)ã‚’åŠ ç®—ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯initã®\(N\)ã‚’ç”¨ã„ã¦ã€\(ÎŸ(log(N))\)</li>
</ul>

<p>sum</p>
<ul>
  <li>\([0,a)\)ã®ç¯„å›²å†…ã«ã‚ã‚‹è¦ç´ ã®å’Œã‚’long longã§è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(log(a))\)</li>
</ul>

<p>inversion</p>
<ul>
  <li>æ•°åˆ—\(V\)ã‚’ä¸ãˆã‚‹ã¨\(V\)ã®è»¢å€’æ•°ã‚’è¨ˆç®—ã—ã€long longã§è¿”ã™</li>
  <li>ã“ã®éš›ã€initã—ç›´ã™ãŸã‚ä»Šã¾ã§ã®å†…å®¹ã‚’ã™ã¹ã¦å‰Šé™¤ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\vert V \vert log \vert V \vert)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/Fenwick%20tree.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Fenwick_tree</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">BIT</span><span class="p">;</span>
    
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">w</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">x</span><span class="o">&lt;</span><span class="n">BIT</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">x</span><span class="o">|=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)){</span>
            <span class="n">BIT</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+=</span><span class="n">w</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">BIT</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">BIT</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">Fenwick_tree</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">sum</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">+=</span><span class="n">BIT</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">inversion</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">V</span><span class="p">){</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">init</span><span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">V</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">add</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">r</span><span class="o">+=</span><span class="n">i</span><span class="o">-</span><span class="n">sum</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-36">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-36">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">Fenwick_tree</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">{</span><span class="mi">100000</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">};</span>
    
    <span class="n">Fenwick_tree</span> <span class="n">BIT</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">BIT</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BIT</span><span class="p">.</span><span class="n">sum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span> <span class="kt">long</span><span class="o">&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">BIT</span><span class="p">.</span><span class="n">inversion</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-36">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
100000
120000
123000
123400
123450
123456

3
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-27">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">ãƒ•ã‚§ãƒ‹ãƒƒã‚¯æœ¨ã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-unionfind-">ğŸ”´ UnionFind ğŸ”´</h1>

<p>DSU(disjoint set union)ã¨ã‚‚</p>

<p>init</p>
<ul>
  <li>æ•´æ•°\(N\)ã‚’ä¸ãˆã‚‹ã¨ã€é ‚ç‚¹ã‚’\(N\)å€‹ç”Ÿæˆã—å…¨ã¦ã‚’ç‹¬ç«‹ã«ã—ãŸä¸Šã§å…¨ã¦ã®ãƒ©ãƒ³ã‚¯ã‚’\(0\)ã«ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(N)\)</li>
</ul>

<p>unionfind</p>
<ul>
  <li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€‚initã‚’å‘¼ã¶</li>
</ul>

<p>root</p>
<ul>
  <li>é ‚ç‚¹\(k\)ã®ãã®æ™‚ç‚¹ã§ã®æ ¹ã‚’æ±‚ã‚ã‚‹</li>
  <li>ã¨åŒæ™‚ã«çµŒè·¯åœ§ç¸®ã™ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\alpha (N))\)</li>
</ul>

<p>\(Î±(x)\)ã¯ã‚¢ãƒƒã‚«ãƒ¼ãƒãƒ³é–¢æ•°\(Ack(x,x)\)ã®é€†é–¢æ•°</p>

<p>\(Ack(4,4)=2^{2^{2^{65536}}}-3\)ã‹ã‚‰ä¼ºãˆã‚‹ã‚ˆã†ã«ã€\(\alpha (x)\)ã¯å®Ÿç”¨ä¸Šå®šæ•°(\(4\))å€ã¨è¦‹ãªã›ã‚‹ã»ã©ã«åæŸãŒé…ã„</p>

<p>same</p>
<ul>
  <li>é ‚ç‚¹\(p\)ã¨é ‚ç‚¹\(q\)ãŒãã®æ™‚ç‚¹ã§åŒã˜é›†åˆã«å±ã—ã¦ã„ã‚‹ã‹(=æ ¹ãŒåŒä¸€ã‹)ã‚’èª¿ã¹ã€åŒã˜ãªã‚‰trueã€é•ã†ãªã‚‰falseã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\alpha (N))\)</li>
</ul>

<p>unite</p>
<ul>
  <li>é ‚ç‚¹\(p\)ã¨é ‚ç‚¹\(q\)ãŒå±ã—ã¦ã‚‹é›†åˆã‚’åˆä½µã™ã‚‹</li>
  <li>ã™ã§ã«åŒã˜é›†åˆã«å±ã—ã¦ã„ã‚‹å ´åˆã¯ç„¡è¦–ã™ã‚‹</li>
  <li>\(p\)ã®å±ã™ã‚‹é›†åˆã®ãƒ©ãƒ³ã‚¯ãŒ\(q\)ã®ã‚‚ã®ã¨åŒã˜ã‹å¤§ãã„ã¨ã\(p\)å´ãŒæ ¹ã«ã€ãã†ã§ãªã„ã¨ã\(q\)å´ãŒæ ¹ã«ãªã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\alpha (N))\)</li>
</ul>

<p>size</p>
<ul>
  <li>é ‚ç‚¹\(k\)ã¨ãã®æ™‚ç‚¹ã§åŒã˜é›†åˆã«å±ã—ã¦ã„ã‚‹é ‚ç‚¹ã®æ•°ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(1)\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/union%20find.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">unionfind</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">size_</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">size_</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">size_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">unionfind</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">size_</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="n">size_</span><span class="p">[</span><span class="n">q</span><span class="p">];</span>
        <span class="n">size_</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">size</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">size_</span><span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">k</span><span class="p">)];</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-37">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-37">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">unionfind</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">unionfind</span> <span class="n">UF</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
    <span class="n">UF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">root</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//1ã¨åŒã˜é›†åˆã«å±ã—ã¦ã„ã‚‹ãªã‚‰1(true)ã€ãã†ã§ãªã„ãªã‚‰0(false)</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">same</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="c1">//åŒã˜é›†åˆã«å…¥ã£ã¦ã„ã‚‹é ‚ç‚¹ãŒã„ãã¤ã‚ã‚‹ã‹</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">12</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">UF</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-37">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 2 1 4 1 4 1 1 4 1 4 1 
1 0 1 0 1 0 1 1 0 1 0 1 
7 1 7 4 7 4 7 7 4 7 4 7 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-28">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/08/31</td>
      <td style="text-align: left">sizeã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">UnionFindã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>

<h1 id="-ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä»˜ãunionfind-">ğŸ”´ ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä»˜ãUnionFind ğŸ”´</h1>

<p>é‡ã¿ä»˜ãUnionFindã£ã¦è¨€ã£ãŸã»ã†ãŒã„ã„ã®ã‹ãªï¼Ÿæ­£ç›´ã‚ã‹ã‚‰ãªã„</p>

<p>å¤§ä½“ã®æ©Ÿèƒ½ã¯<a href="./unionfind">UnionFind</a>ã¨åŒã˜ã§é•ã†ç‚¹ã¯</p>

<p>potential</p>
<ul>
  <li>é ‚ç‚¹\(k\)ã®ãã®æ™‚ç‚¹ã§ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’æ±‚ã‚ã‚‹</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\alpha (N))\)</li>
</ul>

<p>unite</p>
<ul>
  <li>é›†åˆã‚’åˆä½µã™ã‚‹éš›ã«ã€\((Qã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«)-(Pã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«)=d\)ã«ãªã‚‹ã‚ˆã†ã«æŒ‡å®šã™ã‚‹</li>
  <li>P,QãŒåŒã˜é›†åˆã«ã‚ã‚‹å ´åˆã«falseã‚’è¿”ã™</li>
</ul>

<p>diff</p>
<ul>
  <li>\((Qã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«)-(Pã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«)\)ã‚’è¿”ã™</li>
  <li>è¨ˆç®—é‡ã¯\(ÎŸ(\alpha (N))\)</li>
</ul>

<p><a href="https://github.com/0214sh7/procon-library/blob/master/data%20structure/potentialized%20unionfind.cpp">github</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">potentialized_unionfind</span><span class="p">{</span>
    <span class="c1">// Copyright (c) 2023 0214sh7</span>
    <span class="c1">// https://github.com/0214sh7/library/</span>
    <span class="nl">private:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">UF</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">pot</span><span class="p">;</span>
    <span class="nl">public:</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">UF</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">rank</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">UF</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">rank</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">pot</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">potentialized_unionfind</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">){</span>
        <span class="n">init</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
            <span class="n">pot</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pot</span><span class="p">[</span><span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]];</span>
            <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">UF</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">potential</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
        <span class="n">root</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">pot</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">same</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span><span class="kt">int</span> <span class="n">q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="n">root</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="n">unite</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span><span class="p">){</span>
        <span class="c1">//pot(Q)-pot(P)=dã‚’æº€ãŸã™</span>
        <span class="n">d</span><span class="o">+=</span><span class="n">potential</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
        <span class="n">d</span><span class="o">-=</span><span class="n">potential</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="n">root</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">q</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">&lt;</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">]){</span>
            <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
            <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">UF</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="n">rank</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">pot</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">diff</span><span class="p">(</span><span class="kt">int</span> <span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="n">Q</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">potential</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="n">potential</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="p">}</span>
    
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ä½¿ç”¨ä¾‹-38">ä½¿ç”¨ä¾‹</h2>
<hr />

<h3 id="å®Ÿè¡Œã‚³ãƒ¼ãƒ‰-38">å®Ÿè¡Œã‚³ãƒ¼ãƒ‰</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span>
<span class="k">class</span> <span class="nc">potentialized_unionfind</span><span class="p">{</span><span class="cm">/*çœç•¥*/</span><span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    
    <span class="n">potentialized_unionfind</span> <span class="n">potUF</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"é ‚ç‚¹3ã¨é ‚ç‚¹4ã®çµåˆã¯ã§ãã¦ã„ã‚‹ã‹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">c</span> <span class="o">=</span> <span class="n">potUF</span><span class="p">.</span><span class="n">unite</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="nb">true</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"true"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"false"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"é ‚ç‚¹0ã¨ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å·®ã¯ä½•ã‹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">potUF</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"é ‚ç‚¹2ã¨ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å·®ã¯ä½•ã‹"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">potUF</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å‡ºåŠ›-38">å‡ºåŠ›</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>é ‚ç‚¹3ã¨é ‚ç‚¹4ã®çµåˆã¯ã§ãã¦ã„ã‚‹ã‹
false

é ‚ç‚¹0ã¨ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å·®ã¯ä½•ã‹
0 1 3 7 11 

é ‚ç‚¹2ã¨ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å·®ã¯ä½•ã‹
-3 -2 0 4 8 
</code></pre></div></div>

<h2 id="æ›´æ–°å±¥æ­´-29">æ›´æ–°å±¥æ­´</h2>
<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ—¥æ™‚</th>
      <th style="text-align: left">å†…å®¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2023/06/29</td>
      <td style="text-align: left">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´</td>
    </tr>
    <tr>
      <td style="text-align: center">2021/03/26</td>
      <td style="text-align: left">ä½¿ç”¨ä¾‹ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ </td>
    </tr>
    <tr>
      <td style="text-align: center">2020/04/06</td>
      <td style="text-align: left">ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä»˜ãUnionFindã‚’è¿½åŠ </td>
    </tr>
  </tbody>
</table>

<div style="page-break-after: always;"></div>


  </body>
</html>
  </div><a class="u-url" href="/library/posts/wild" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/library/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">ã™ããƒ©ã‚¤ãƒ–ãƒ©ãƒª</li><li><a class="u-email" href="mailto:0214sh7@gmail.com">0214sh7@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/0214sh7"><svg class="svg-icon"><use xlink:href="/library/assets/minima-social-icons.svg#github"></use></svg> <span class="username">0214sh7</span></a></li><li><a href="https://www.twitter.com/0214sh7"><svg class="svg-icon"><use xlink:href="/library/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">0214sh7</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
